<template>
  <div class="container">
    <div class="first-box" ref="firstBox">
      <img
        src="@/assets/image/Home/01bck.png"
        alt="Header Image"
        class="header-image"
        ref="headerImage"
      />
      <div
        class="faceBox"
        ref="faceBox"
        :class="{ 'faceBox-up': isFaceBoxChange }"
      >
        <div class="first-face-title">
          <p>ä¸­åæ–‡åŒ–</p>
        </div>
        <div class="face-text">
          <p>
            ä¸­åä¼ ç»Ÿæ–‡åŒ–ï¼Œå¦‚æ¶“æ¶“ç»†æµæ±‡èšæˆæ²³ï¼Œäº”åƒå¹´çš„æ™ºæ…§ç»“æ™¶ï¼Œé—ªè€€ç€å…ˆå“²çš„å…‰èŠ’ã€‚å„’å®¶ä»çˆ±ã€é“å®¶è‡ªç„¶ï¼Œè¯—è¯æ­Œèµ‹åŸå’ä¸å°½ï¼Œä¼ ç»ŸèŠ‚æ—¥ä¼ æ‰¿åƒå¹´æƒ…è°Šï¼Œå®›å¦‚ä¸€å¹…æ°´å¢¨ç”»å·ï¼Œè¯—æ„ç›ç„¶ï¼Œä¹¦å†™ç€ä¸­åæ°‘æ—çš„çµé­‚ä¸æ¢¦æƒ³ã€‚
          </p>
        </div>
      </div>
    </div>
    <div class="second-box">
      <div
        class="wrapper"
        :style="{
          backgroundColor: nowColor.code ? '#' + nowColor.code : '#ddd',
        }"
      >
        <div class="color-box">
          <div class="color-list">
            <div
              class="color-item"
              v-for="(color, index) in colors"
              :key="index"
              :style="{ borderColor: '#' + color.code }"
              @click="changeColor(color)"
            >
              <div class="color-top">
                <div class="top-size">
                  <el-progress
                    type="circle"
                    :show-text="false"
                    :percentage="color.C"
                    color="#fff"
                    :width="width30"
                    :stroke-width="strokeWidth"
                    stroke-linecap="butt"
                    class="top-value"
                    define-back-color="rgba(255,255,255,0.2)"
                  ></el-progress>
                  <el-progress
                    type="circle"
                    :show-text="false"
                    :percentage="color.M"
                    color="#fff"
                    :width="width30"
                    :stroke-width="strokeWidth"
                    stroke-linecap="butt"
                    class="top-value"
                    define-back-color="rgba(255,255,255,0.2)"
                  ></el-progress>
                  <el-progress
                    type="circle"
                    :show-text="false"
                    :percentage="color.Y"
                    color="#fff"
                    :width="width30"
                    :stroke-width="strokeWidth"
                    stroke-linecap="butt"
                    class="top-value"
                    define-back-color="rgba(255,255,255,0.2)"
                  ></el-progress>
                  <el-progress
                    type="circle"
                    :show-text="false"
                    :percentage="color.K"
                    color="#fff"
                    :width="width30"
                    :stroke-width="strokeWidth"
                    stroke-linecap="butt"
                    class="top-value"
                    define-back-color="rgba(255,255,255,0.2)"
                  ></el-progress>
                </div>
                <div class="top-name" :style="{ color: '#' + color.code }">
                  {{ color.name }}
                </div>
              </div>
              <div class="color-bottom">
                <div class="bottom-name">{{ color.pinyin }}</div>
                <div class="bottom-size">
                  {{ color.R }},{{ color.G }},{{ color.B }}
                </div>
                <div class="bottom-code">{{ color.code }}</div>
              </div>
            </div>
          </div>
        </div>
        <div class="message-box">
          <div class="color-value">
            <div class="C cmyk color-son">
              <div class="color-title">
                <p>C</p>
              </div>
              <div class="color-circular">
                <el-progress
                  type="circle"
                  :percentage="nowColor.C"
                  :show-text="false"
                  :width="width"
                  color="#0093D3"
                  stroke-linecap="butt"
                >
                </el-progress>
                <span>{{ nowColor.C }}</span>
              </div>
            </div>
            <div class="M cmyk color-son">
              <div class="color-title">
                <p>M</p>
              </div>
              <div class="color-circular">
                <el-progress
                  type="circle"
                  :percentage="nowColor.M"
                  :show-text="false"
                  :width="width"
                  color="#CC006B"
                  stroke-linecap="butt"
                >
                </el-progress>
                <span>{{ nowColor.M }}</span>
              </div>
            </div>
            <div class="Y cmyk color-son">
              <div class="color-title">
                <p>Y</p>
              </div>
              <div class="color-circular">
                <el-progress
                  type="circle"
                  :percentage="nowColor.Y"
                  :show-text="false"
                  :width="width"
                  color="#FFF10C"
                  stroke-linecap="butt"
                >
                </el-progress>
                <span>{{ nowColor.Y }}</span>
              </div>
            </div>
            <div class="K cmyk color-son">
              <div class="color-title">
                <p>K</p>
              </div>
              <div class="color-circular">
                <el-progress
                  type="circle"
                  :percentage="nowColor.K"
                  :show-text="false"
                  :width="width"
                  color="#000000"
                  stroke-linecap="butt"
                >
                </el-progress>
                <span>{{ nowColor.K }}</span>
              </div>
            </div>
            <div class="R rgb color-son">
              <div class="color-title">
                <p>R</p>
              </div>
              <span>{{ nowColor.R }}</span>
            </div>
            <div class="G rgb color-son">
              <div class="color-title">
                <p>G</p>
              </div>
              <span>{{ nowColor.G }}</span>
            </div>
            <div class="B rgb color-son">
              <div class="color-title">
                <p>B</p>
              </div>
              <span>{{ nowColor.B }}</span>
            </div>
          </div>
          <div class="color-name">
            <p class="p-name">{{ nowColor.name }}</p>
            <p class="p-pinyin">{{ nowColor.pinyin }}</p>
            <p class="p-pinyin">
              {{ nowColor.code ? "#" + nowColor.code : "#ddd" }}
            </p>
          </div>
          <div class="color-img">
            <img src="@/assets/image/Home/03bck.png" alt="" />
          </div>
        </div>
        <div class="wrapper-title">
          <span>ä¸€çœ¼åƒå¹´</span>
          <span>ç»®å½©ç›ˆç¬º</span>
        </div>
      </div>
    </div>
    <div class="third-box" ref="thirdBox">
      <div
        class="third-top-left"
        :style="{ transform: `translateY(${topLeftOffset}vh)` }"
      >
        <span>ä¼ </span>
      </div>
      <div
        class="third-top-right"
        :style="{ transform: `translateY(${topRightOffset}vh)` }"
      >
        <span>ç»Ÿ</span>
        <img
          src="https://news.cgtn.com/event/2022/The-Song-Painted/style/img/introduceFloat02.png"
          @click="thirdNext"
          class="third-click-btn-next"
        />
      </div>

      <div class="third-bottom">
        <img
          src="https://news.cgtn.com/event/2022/The-Song-Painted/style/img/introduceFloat02.png"
          @click="thirdLast"
          class="third-click-btn-last"
          v-if="showBtn"
        />

        <div class="third-bottom-title">
          <div style="width: 20vw; height: 5vh"></div>
          <h2>åƒå¹´æ–‡åŒ–éŸµï¼Œæµè½¬åœ¨ä»Šæœ</h2>
        </div>
        <div class="third-bottom-contain">
          <div class="third-bottom-contain-left">
            <div class="video-box" @click="showVideo(0)">
              <div class="video-face">
                <div class="face-img">
                  <img src="@/assets/image/Home/gh.png" alt="" />
                </div>
                <div class="face-title">
                  <h2>å›½ç”»</h2>
                  <p>
                    å›½ç”»æ˜¯ä¸­å›½çš„ä¼ ç»Ÿç»˜ç”»å½¢å¼ï¼Œæ˜¯ç”¨æ¯›ç¬”è˜¸æ°´ã€å¢¨ã€å½©ä½œç”»äºç»¢æˆ–çº¸ä¸Š
                  </p>
                </div>
              </div>
            </div>
            <div class="video-box" @click="showVideo(2)">
              <div class="video-face">
                <div class="face-img">
                  <img src="@/assets/image/Home/cq.png" alt="" />
                </div>
                <div class="face-title">
                  <h2>ç“·å™¨</h2>
                  <p>ä¸­å›½æ˜¯ç“·å™¨çš„æ•…ä¹¡ï¼Œç“·å™¨æ˜¯å¤ä»£åŠ³åŠ¨äººæ°‘çš„ä¸€ä¸ªé‡è¦çš„åˆ›é€ </p>
                </div>
              </div>
            </div>
            <div class="video-box" @click="showVideo(1)">
              <div class="video-face">
                <div class="face-img">
                  <img src="@/assets/image/Home/sc.png" alt="" />
                </div>
                <div class="face-title">
                  <h2>ä¸ç»¸</h2>
                  <p>
                    ä¸ç»¸æ˜¯ä¸­å›½çš„ç‰¹äº§ï¼Œä¸­å›½å¤ä»£åŠ³åŠ¨äººæ°‘å‘æ˜å¹¶å¤§è§„æ¨¡ç”Ÿäº§ä¸ç»¸åˆ¶å“ï¼Œæ›´å¼€å¯äº†ä¸–ç•Œå†å²ä¸Šç¬¬ä¸€æ¬¡ä¸œè¥¿æ–¹å¤§è§„æ¨¡çš„å•†è´¸äº¤æµï¼Œå²ç§°â€œä¸ç»¸ä¹‹è·¯â€
                  </p>
                </div>
              </div>
            </div>
            <div class="video-box" @click="showVideo(3)">
              <div class="video-face">
                <div class="face-img">
                  <img src="@/assets/image/Home/zy.png" alt="" />
                </div>
                <div class="face-title">
                  <h2>ä¸­åŒ»</h2>
                  <p>
                    ä¸­åŒ»å­¦æœ‰æ•°åƒå¹´çš„å†å²ï¼Œæ˜¯ä¸­åæ°‘æ—åœ¨é•¿æœŸçš„ç”Ÿäº§ä¸ç”Ÿæ´»å®è·µä¸­è®¤è¯†ç”Ÿå‘½ã€ç»´æŠ¤å¥åº·ã€æˆ˜èƒœç–¾ç—…çš„å®è´µç»éªŒæ€»ç»“ï¼Œæ˜¯ä¸­å›½ä¼ ç»Ÿæ–‡åŒ–çš„ç»“æ™¶
                  </p>
                </div>
              </div>
            </div>
          </div>
          <div class="third-bottom-contain-right">
            <div class="third-bottom-right-son1">
              <div class="son-box" @click="changePage('Jingjv')">
                <div class="son-box-img">
                  <img src="@/assets/image/Home/jj.png" alt="" />
                </div>
                <div class="son-box-text">
                  <h2>äº¬å‰§</h2>
                  <p>
                    äº¬å‰§æ˜¯è‡³ä»Šä¸­å›½æˆæ›²èˆå°ä¸Šæœ€å…·ä»£è¡¨æ€§ã€å½±å“åŠ›çš„å‰§ç§ï¼Œè¢«èª‰ä¸ºâ€œå›½ç²¹â€
                  </p>
                </div>
              </div>
              <div class="cloud2">
                <img src="@/assets/image/Home/cloud2.png" alt="" />
              </div>
              <div class="son-box" @click="changePage('Cixiu')">
                <div class="son-box-img">
                  <img src="@/assets/image/Home/syi.png" alt="" />
                </div>
                <div class="son-box-text">
                  <h2>åˆºç»£</h2>
                  <p>
                    åˆºç»£æ˜¯é’ˆå’Œçº¿åœ¨ç»‡ç‰©ä¸Šçš„ä¸€ç§è‰ºæœ¯ï¼Œä¹Ÿæ˜¯ä¸­å›½éç‰©è´¨æ–‡åŒ–é—äº§ä¿æŠ¤ä¸­æœ€çè´µçš„ç‰©ç§ä¹‹ä¸€
                  </p>
                </div>
              </div>
            </div>
            <div class="third-bottom-right-son2">
              <div class="cloud1">
                <img src="@/assets/image/Home/cloud1.png" alt="" />
              </div>
              <div class="cloud2 cloud21">
                <img src="@/assets/image/Home/cloud2.png" alt="" />
              </div>
              <div class="cloud1">
                <img src="@/assets/image/Home/cloud1.png" alt="" />
              </div>
            </div>
            <div class="third-bottom-right-son3">
              <div class="son-box" @click="changePage('Rujia')">
                <div class="son-box-img">
                  <img src="@/assets/image/Home/rj.png" alt="" />
                </div>
                <div class="son-box-text">
                  <h2>å„’å®¶æ–‡åŒ–</h2>
                  <p>
                    å„’å®¶æ–‡åŒ–æ˜¯ä»¥å„’å®¶å­¦è¯´ä¸ºæŒ‡å¯¼æ€æƒ³çš„æ–‡åŒ–æµæ´¾ï¼Œä¸ºå†ä»£å„’å®¢ä¿¡ä¼—æ¨å´‡
                  </p>
                </div>
              </div>
              <div class="cloud2">
                <img src="@/assets/image/Home/cloud2.png" alt="" />
              </div>
              <div class="son-box" @click="changePage('Zhongyi')">
                <div class="son-box-img">
                  <img src="@/assets/image/Home/zyi.png" alt="" />
                </div>
                <div class="son-box-text">
                  <h2>ä¸­åŒ»æ–‡åŒ–</h2>
                  <p>
                    ä¸­åŒ»å…·æœ‰å®Œæ•´çš„ç†è®ºä½“ç³»ï¼Œå…¶ç‹¬ç‰¹ä¹‹å¤„åœ¨äºå¤©äººåˆä¸€ã€å¤©äººç›¸åº”çš„æ•´ä½“è§‚åŠè¾¨è¯è®ºæ²»
                  </p>
                </div>
              </div>
            </div>
            <div class="third-bottom-right-son4">
              <div class="son4-box" @click="changePage('Hanfu')">
                <div class="son4-box-img">
                  <img src="@/assets/image/Home/hf.png" alt="" />
                </div>
                <div class="son4-box-text">
                  <h2>æ±‰æœ</h2>
                  <p>
                    æ±‰æœæ˜¯ä¸­å›½â€œè¡£å† ä¸Šå›½â€â€œç¤¼ä»ªä¹‹é‚¦â€â€œé”¦ç»£ä¸­åâ€çš„ä½“ç°ï¼Œæ‰¿è½½äº†ä¸­å›½çš„æŸ“ç»‡ç»£ç­‰æ°å‡ºå·¥è‰ºå’Œç¾å­¦
                  </p>
                </div>
              </div>
            </div>
          </div>
        </div>
        <el-drawer
          title="video"
          size="80%"
          :visible.sync="isShowVideo"
          :with-header="false"
          class="tvBox"
        >
          <video
            :src="nowVideo"
            v-if="isShowVideo"
            controls
            fit="fill"
            style="width: 100%; height: 100%"
          ></video>
        </el-drawer>
      </div>
    </div>

    <div
      class="fourth-box"
      ref="fourthBox"
      :class="isExpandMap ? '' : 'hideMap'"
    >
      <div class="mapBox">
        <div class="allMapBox">
          <div id="allmap"></div>
        </div>

        <div class="mapChange" @click="isExpandMap = !isExpandMap">
          <i class="el-icon-d-arrow-left" v-if="isExpandMap"></i>
          <i class="el-icon-d-arrow-right" v-if="!isExpandMap"></i>
        </div>
      </div>
      <div class="fourth-right">
        <div
          class="cultureBox"
          ref="cultureBox"
          :class="isExpandMap ? '' : 'hide-cultureBox'"
        >
          <div class="dialogBox">
            <div class="avatarBox" @click="changePage('Center')">
              <img class="ai" src="@/assets/image/Home/ai.gif" />
            </div>
            <div class="contentBox">
              <div class="contentText">
                <p>æˆ‘å«å¤æ™“ï¼Œä½ çš„ä¸ªäººAIåŠ©æ‰‹<br />æˆ‘å¯ä»¥ä¸ºä½ åšä»¥ä¸‹äº‹:</p>
                <!-- <p>æˆ‘å«å¤æ™“</p> -->
              </div>
              <div class="contentModule">
                <div class="cultureIntroduce">
                  <h4 style="margin: 5px; font-family: kaiti">æ–‡åŒ–å±•ç¤º</h4>
                  <p
                    style="
                      margin-left: 5px;
                      line-height: 18px;
                      letter-spacing: 3px;
                      font-family: kaiti;
                    "
                  >
                    é€‰æ‹©åœ°å›¾ä¸Š<br />çš„åŸå¸‚æŸ¥çœ‹å½“åœ°<br />æ–‡åŒ–
                  </p>
                </div>
                <div class="questionAnswer">
                  <h4 style="margin: 5px; font-family: kaiti">
                    çŸ¥å¤©æ–‡<br />åœ°ç†
                  </h4>
                  <p
                    style="
                      margin-left: 5px;
                      line-height: 18px;
                      letter-spacing: 3px;
                      font-family: kaiti;
                    "
                  >
                    ä¸ºä½ ç­”ç–‘<br />è§£æƒ‘
                  </p>
                </div>
                <div class="moduleSonBox">
                  <div class="scenicIntroduce" style="text-align: right">
                    <h4 style="margin: 5px; font-family: kaiti">æ™¯ç‚¹ä»‹ç»</h4>
                    <p
                      style="
                        margin-right: 5px;
                        line-height: 18px;
                        letter-spacing: 3px;
                        font-family: kaiti;
                      "
                    >
                      å¯»å¤äºº<br />æ¸¸è¸ª
                    </p>
                  </div>
                  <div class="AIDraw">
                    <h4 style="margin: 5px; font-family: kaiti">ç´æ£‹ä¹¦ç”»</h4>
                    <p
                      style="
                        margin-left: 5px;
                        line-height: 18px;
                        letter-spacing: 3px;
                        font-family: kaiti;
                      "
                    >
                      å¤æ³•ä¼ æ‰¿<br />AIç»˜ç”»
                    </p>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div v-for="(chat, index) in chats" :key="index">
            <div
              class="dialogBox"
              :class="chat.type === 'user' ? 'dialogBox-right' : ''"
            >
              <div
                class="avatarBox"
                :class="chat.type === 'user' ? 'avatarBox-right' : ''"
                @click="changePage('Center')"
              >
                <img class="ai" :src="chat.avatar" />
              </div>

              <div
                class="contentBox"
                :class="chat.type === 'user' ? 'contentBox-right' : ''"
              >
                <div class="contentText" v-if="chat.type === 'user'">
                  <p>{{ chat.content.trim() }}</p>
                  <img class="aiImg" :src="chat.imgUrl" v-if="chat.imgUrl" />
                </div>
                <div class="contentText" v-if="chat.type !== 'user'">
                  <div
                    class="thinking"
                    v-html="chat.thinking"
                    v-if="chat.thinking"
                  ></div>
                  <div v-html="chat.answer"></div>
                  <img class="aiImg" :src="chat.imgUrl" v-if="chat.imgUrl" />
                </div>
                <div class="contentModule" v-if="chat.modules.length">
                  <div
                    class="cultureIntroduce"
                    @click="changePage('City')"
                    :style="{ backgroundImage: `url(${chat.modules[0].bck})` }"
                  >
                    <h4 style="margin: 5px; font-family: kaiti">
                      {{ chat.modules[0].title }}
                    </h4>
                    <p
                      style="
                        margin-left: 5px;
                        line-height: 18px;
                        letter-spacing: 3px;
                        font-family: kaiti;
                      "
                    >
                      {{ chat.modules[0].tip }}
                    </p>
                  </div>
                  <div
                    class="questionAnswer"
                    @click="changePage('City')"
                    :style="{ backgroundImage: `url(${chat.modules[1].bck})` }"
                  >
                    <h4 style="margin: 5px; font-family: kaiti">
                      {{ chat.modules[1].title }}
                    </h4>
                    <p
                      style="
                        margin-left: 5px;
                        line-height: 18px;
                        letter-spacing: 3px;
                        font-family: kaiti;
                      "
                    >
                      {{ chat.modules[1].tip }}
                    </p>
                  </div>
                  <div class="moduleSonBox">
                    <div
                      class="scenicIntroduce"
                      @click="changePage('City')"
                      style="text-align: right"
                      :style="{
                        backgroundImage: `url(${chat.modules[2].bck})`,
                      }"
                    >
                      <h4 style="margin: 5px; font-family: kaiti">
                        {{ chat.modules[2].title }}
                      </h4>
                      <p
                        style="
                          margin-right: 5px;
                          line-height: 18px;
                          letter-spacing: 3px;
                          font-family: kaiti;
                        "
                      >
                        {{ chat.modules[2].tip }}
                      </p>
                    </div>
                    <div
                      class="AIDraw"
                      :style="{
                        backgroundImage: `url(${chat.modules[3].bck})`,
                      }"
                      @click="changePage('City')"
                    >
                      <h4 style="margin: 5px; font-family: kaiti">
                        {{ chat.modules[3].title }}
                      </h4>
                      <p
                        style="
                          margin-left: 5px;
                          line-height: 18px;
                          letter-spacing: 3px;
                          font-family: kaiti;
                        "
                      >
                        {{ chat.modules[3].tip }}
                      </p>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div class="operateBox" v-if="chat.type === 'user' ? false : true">
              <el-popover
                placement="top-start"
                width="250"
                height="500"
                trigger="hover"
              >
                <el-table
                  :data="languageData"
                  height="250"
                  @row-click="(row) => changLanguage(chat.id, row)"
                >
                  <el-table-column
                    width="100"
                    property="englishName"
                    label="è‹±æ–‡å"
                  ></el-table-column>
                  <el-table-column
                    width="150"
                    property="chineseName"
                    label="ä¸­æ–‡å"
                  ></el-table-column>
                </el-table>
                <img
                  slot="reference"
                  src="@/assets/image/Home/fanyi.png"
                  @click="translateText(chat.id)"
                />
              </el-popover>
            </div>
          </div>

          <div class="dialogBox" v-if="isThinking">
            <div class="avatarBox">
              <img
                class="ai"
                src="https://oss-mtc.oss-cn-hangzhou.aliyuncs.com/2c927a761478a4a4248706b534bac146.gif"
              />
            </div>
            <div class="contentBox">
              <div class="contentText">
                <i class="el-icon-loading" style="color: gray"></i>
              </div>
            </div>
          </div>
        </div>
        <div class="inputBox" :class="isExpandMap ? '' : 'hide-inputBox'">
          <div v-if="limitTip" class="limit-tip">
            <span style="color: red">{{ textarea.length }}</span
            ><span style="color: gray">/10000</span>
          </div>
          <div class="chatImg">
            <img class="uploadImg" :src="uploadImgUrl" v-if="uploadImgUrl" />
            <div class="deleteDiv" @click="deleteUploadImgUrl">
              <i class="el-icon-delete"></i>
            </div>
            <input
              type="file"
              accept="image/*"
              @change="handleFileUpload"
              ref="fileInput"
              style="display: none"
            />
          </div>
          <textarea
            class="question-textarea"
            :class="isExpandMap ? '' : 'hide-question-textarea'"
            maxlength="10000"
            v-model="textarea"
            :style="{ height: textareaHeight + 'vh' }"
            @input="adjustHeight"
            ref="questionTextarea"
            placeholder="ä¸‡äº‹ç–‘æƒ‘è¯¢å¤æ™“"
            @keydown.enter.prevent="sendMessage('')"
          ></textarea>
          <el-tooltip
            slot="suffix"
            class="item"
            effect="light"
            content="è¿˜æ²¡è¯´å‘¢"
            placement="top-end"
            v-show="isTextEmpty"
          >
            <i :class="iconClass" class="el-icon-s-promotion"></i>
          </el-tooltip>
          <i
            slot="suffix"
            :class="iconClass"
            class="el-icon-s-promotion el-icon-s-promotion-allowed"
            v-show="!isTextEmpty"
            @click="sendMessage('')"
          ></i>
          <i class="el-icon-microphone"></i>
          <el-tooltip
            slot="suffix"
            class="item"
            effect="light"
            :content="!isRecording ? 'è¯­éŸ³è¾“å…¥' : 'åœæ­¢è¯­éŸ³è¾“å…¥'"
            placement="top-end"
          >
            <i
              class="el-icon-microphone"
              :class="isRecording ? 'saying' : ''"
              @click="sayingInMessage"
            ></i>
          </el-tooltip>
          <el-tooltip
            slot="suffix"
            class="item"
            effect="light"
            content="AIè¯†å›¾"
            placement="top-end"
          >
            <i class="el-icon-picture-outline-round" @click="showFileInput"></i>
          </el-tooltip>
        </div>
      </div>
      <div
        class="fourth-right-right"
        :class="isExpandMap ? '' : 'hide-right-right'"
      >
        <div class="history-container">
          <div class="history-header">
            <span class="history-icon">ğŸ•’</span>

            <span class="history-title">å¯¹è¯æ—¶å…‰æœº</span>
            <el-tooltip effect="dark" content="è®¾ç½®" placement="top">
              <i
                class="el-icon-setting"
                @click="isShowDialog = true"
                style="cursor: pointer"
              ></i>
            </el-tooltip>
            <el-tooltip effect="dark" content="æ–°å¯¹è¯" placement="top">
              <i
                class="el-icon-circle-plus-outline newSaying"
                @click="newSaying"
              ></i>
            </el-tooltip>
            <el-tooltip effect="dark" content="é€€å‡ºç™»å½•" placement="top">
              <img
                src="@/assets/image/Home/tuichudenglu.png"
                class="exit"
                @click="exit"
              />
            </el-tooltip>
          </div>
          <div class="history-list">
            <el-collapse v-model="activeName" accordion>
              <el-collapse-item
                :title="time"
                :name="time"
                v-for="(historyItem, time) in historyes.histories"
                :key="time"
                class="history-item"
              >
                <template #title>
                  <span class="history-time">{{ time }}</span>
                </template>
                <!-- <div
                >
                  <span v-if="historyItem.messages[0].type === 'user'">ç”¨æˆ·: </span>
                  <span v-if="historyItem.messages[0].type === 'assistant'">åŠ©æ‰‹: </span>
                  {{ historyItem.messages[0].text }}
                </div>
                <div
                >
                  <span v-if="historyItem.messages[1].type === 'user'">ç”¨æˆ·: </span>
                  <span v-if="historyItem.messages[1].type === 'assistant'">åŠ©æ‰‹: </span>
                  {{ historyItem.messages[1].text }}
                </div> -->
                <div
                  v-for="(msg, index) in historyItem.messages.slice(0, 2)"
                  :key="index"
                >
                  <span v-if="msg.role === 'user'">ç”¨æˆ·: </span>
                  <span v-if="msg.role === 'assistant'">åŠ©æ‰‹: </span>
                  {{ msg.content }}
                </div>

                <div class="history-actions">
                  <el-tooltip effect="dark" content="æ¢å¤å¯¹è¯" placement="top">
                    <el-button
                      type="success"
                      icon="el-icon-refresh-left"
                      circle
                      @click="backHistory(historyItem.historyId)"
                    ></el-button>
                  </el-tooltip>
                  <el-tooltip effect="dark" content="åˆ é™¤è®°å½•" placement="top">
                    <el-button
                      type="danger"
                      icon="el-icon-delete"
                      circle
                      @click="deleteHistory(historyItem.historyId)"
                    ></el-button>
                  </el-tooltip>
                </div>
              </el-collapse-item>
            </el-collapse>
          </div>
        </div>
      </div>
      <div class="dialog" v-if="isShowDialog">
        <div class="dialog-close">
          <i class="el-icon-close" @click="isShowDialog = false"></i>
        </div>
        <div class="block">
          <span class="demonstration">é€Ÿåº¦</span>
          <el-slider
            v-model="value1"
            :format-tooltip="formatTooltip"
          ></el-slider>
        </div>
        <div class="block">
          <span class="demonstration">å›ç­”æ¸©åº¦</span>
          <el-slider
            v-model="value2"
            :format-tooltip="formatTooltip"
          ></el-slider>
        </div>
        <div class="block">
          <span class="demonstration">æ•°æ®æº</span>
          <el-slider
            v-model="value3"
            :format-tooltip="formatTooltip"
          ></el-slider>
        </div>
        <div class="block">
          <span class="demonstration">max token</span>
          <el-slider
            v-model="value4"
            :format-tooltip="formatTooltip"
          ></el-slider>
        </div>
        <div class="dialog-yes">
          <el-button type="primary" @click="dialogYes">ç¡®è®¤æ›´æ”¹</el-button>
        </div>
      </div>
    </div>
  </div>
</template>

<script>
import MarkdownIt from "markdown-it";
import allProvinceBoundaries from "@/assets/json/all-province-boundaries.json";
import allCityBoundaries from "@/assets/json/all-city-boundaries.json";
import axios from "axios";
import { time } from "echarts";
export default {
  name: "Home",

  data() {
    return {
      isFaceBoxChange: false,
      num: 50,
      width: 60,
      width30: 30,
      strokeWidth: 7,
      percentage100: 100,
      percentage10: 10,
      isShowVideo: false,
      nowVideo: "",
      cityName: "",
      provinceFillLayer: null,
      cityBoundaryLayer: null,
      highlightedPolygon: null,
      textarea: "",
      textareaHeight: 3,
      isThinking: false,
      isRecording: false,
      transcript: "", // å­˜å‚¨è¯­éŸ³è½¬æ–‡å­—çš„ç»“æœ
      recognition: null, // å­˜å‚¨ SpeechRecognition å®ä¾‹
      answerText: "",
      displayText: "", // å½“å‰æ˜¾ç¤ºçš„æ–‡æœ¬å†…å®¹
      index: 0, // å½“å‰å¤„ç†åˆ°çš„å­—ç¬¦ç´¢å¼•
      speed: 100, // å­—ç¬¦æ˜¾ç¤ºçš„é€Ÿåº¦ï¼Œå•ä½ä¸ºæ¯«ç§’
      isPaused: false, // æš‚åœçŠ¶æ€æ ‡å¿—
      timer: null, // å®šæ—¶å™¨å˜é‡ï¼Œç”¨äºæ§åˆ¶å­—ç¬¦æ˜¾ç¤ºçš„æ—¶é—´é—´éš”
      cityData: allCityBoundaries, // ç›´æ¥å¯¼å…¥åŸå¸‚è¾¹ç•Œæ•°æ®
      translateLanguage: "en",
      selectedFile: "",
      isExpandMap: true,
      activeName: "",
      dialogTableVisible: false,
      value3: 30,
      value2: 50,
      value1: 40,
      value4: 55,
      isShowDialog: false,
      historyId: "",
      uploadImgUrl: "",
      answerBuffer: "",
      thinkingBuffer: "",
      md: null,
      thinkingCompleteMarkdown: "",
      answerCompleteMarkdown: "",
      translateId: 0,
      topRightOffset: parseFloat(sessionStorage.getItem("topRightOffset")) || 0,
      topLeftOffset: parseFloat(sessionStorage.getItem("topLeftOffset")) || 0,
      showBtn: sessionStorage.getItem("showBtn") === "true", // åˆå§‹åŒ– showBtn çŠ¶æ€

      languageData: [
        {
          englishName: "English",
          chineseName: "è‹±è¯­",
          code: "en",
          autoRecognition: "Y",
        },
        {
          englishName: "Chinese",
          chineseName: "ç®€ä½“ä¸­æ–‡",
          code: "zh-CHS",
          autoRecognition: "Y",
        },
        {
          englishName: "Spanish",
          chineseName: "è¥¿ç­ç‰™è¯­",
          code: "es",
          autoRecognition: "Y",
        },
        {
          englishName: "Arabic",
          chineseName: "é˜¿æ‹‰ä¼¯è¯­",
          code: "ar",
          autoRecognition: "Y",
        },
        {
          englishName: "French",
          chineseName: "æ³•è¯­",
          code: "fr",
          autoRecognition: "Y",
        },
        {
          englishName: "Russian",
          chineseName: "ä¿„è¯­",
          code: "ru",
          autoRecognition: "Y",
        },
        {
          englishName: "Hindi",
          chineseName: "å°åœ°è¯­",
          code: "hi",
          autoRecognition: "Y",
        },
        {
          englishName: "Portuguese",
          chineseName: "è‘¡è„ç‰™è¯­",
          code: "pt",
          autoRecognition: "Y",
        },
        {
          englishName: "Japanese",
          chineseName: "æ—¥è¯­",
          code: "ja",
          autoRecognition: "Y",
        },
        {
          englishName: "German",
          chineseName: "å¾·è¯­",
          code: "de",
          autoRecognition: "Y",
        },
        {
          englishName: "Indonesian",
          chineseName: "å°åº¦å°¼è¥¿äºšè¯­",
          code: "id",
          autoRecognition: "Y",
        },
        {
          englishName: "Italian",
          chineseName: "æ„å¤§åˆ©è¯­",
          code: "it",
          autoRecognition: "Y",
        },
        {
          englishName: "Korean",
          chineseName: "éŸ©è¯­",
          code: "ko",
          autoRecognition: "Y",
        },
        {
          englishName: "Dutch",
          chineseName: "è·å…°è¯­",
          code: "nl",
          autoRecognition: "Y",
        },
        {
          englishName: "Thai",
          chineseName: "æ³°è¯­",
          code: "th",
          autoRecognition: "Y",
        },
        {
          englishName: "Vietnamese",
          chineseName: "è¶Šå—è¯­",
          code: "vi",
          autoRecognition: "Y",
        },
        {
          englishName: "Chinese",
          chineseName: "ç¹ä½“ä¸­æ–‡",
          code: "zh-CHT",
          autoRecognition: "Y",
        },
        {
          englishName: "Afrikaans",
          chineseName: "å—éè·å…°è¯­",
          code: "af",
          autoRecognition: "Y",
        },
        {
          englishName: "Amharic",
          chineseName: "é˜¿å§†å“ˆæ‹‰è¯­",
          code: "am",
          autoRecognition: "N",
        },
        {
          englishName: "Azerbaijani",
          chineseName: "é˜¿å¡æ‹œç–†è¯­",
          code: "az",
          autoRecognition: "Y",
        },
        {
          englishName: "Belarusian",
          chineseName: "ç™½ä¿„ç½—æ–¯è¯­",
          code: "be",
          autoRecognition: "Y",
        },
        {
          englishName: "Bulgarian",
          chineseName: "ä¿åŠ åˆ©äºšè¯­",
          code: "bg",
          autoRecognition: "Y",
        },
        {
          englishName: "Bangla",
          chineseName: "å­ŸåŠ æ‹‰è¯­",
          code: "bn",
          autoRecognition: "Y",
        },
        {
          englishName: "Bosnian (Latin)",
          chineseName: "æ³¢æ–¯å°¼äºšè¯­",
          code: "bs",
          autoRecognition: "Y",
        },
        {
          englishName: "Catalan",
          chineseName: "åŠ æ³°éš†è¯­",
          code: "ca",
          autoRecognition: "Y",
        },
        {
          englishName: "Cebuano",
          chineseName: "å®¿åŠ¡è¯­",
          code: "ceb",
          autoRecognition: "N",
        },
        {
          englishName: "Corsican",
          chineseName: "ç§‘è¥¿å˜‰è¯­",
          code: "co",
          autoRecognition: "N",
        },
        {
          englishName: "Czech",
          chineseName: "æ·å…‹è¯­",
          code: "cs",
          autoRecognition: "Y",
        },
        {
          englishName: "Welsh",
          chineseName: "å¨å°”å£«è¯­",
          code: "cy",
          autoRecognition: "Y",
        },
        {
          englishName: "Danish",
          chineseName: "ä¸¹éº¦è¯­",
          code: "da",
          autoRecognition: "Y",
        },
        {
          englishName: "Greek",
          chineseName: "å¸Œè…Šè¯­",
          code: "el",
          autoRecognition: "Y",
        },
        {
          englishName: "Esperanto",
          chineseName: "ä¸–ç•Œè¯­",
          code: "eo",
          autoRecognition: "Y",
        },
        {
          englishName: "Estonian",
          chineseName: "çˆ±æ²™å°¼äºšè¯­",
          code: "et",
          autoRecognition: "Y",
        },
        {
          englishName: "Basque",
          chineseName: "å·´æ–¯å…‹è¯­",
          code: "eu",
          autoRecognition: "Y",
        },
        {
          englishName: "Persian",
          chineseName: "æ³¢æ–¯è¯­",
          code: "fa",
          autoRecognition: "Y",
        },
        {
          englishName: "Finnish",
          chineseName: "èŠ¬å…°è¯­",
          code: "fi",
          autoRecognition: "Y",
        },
        {
          englishName: "Fijian",
          chineseName: "æ–æµè¯­",
          code: "fj",
          autoRecognition: "N",
        },
        {
          englishName: "Frisian",
          chineseName: "å¼—é‡Œè¥¿è¯­",
          code: "fy",
          autoRecognition: "Y",
        },
        {
          englishName: "Irish",
          chineseName: "çˆ±å°”å…°è¯­",
          code: "ga",
          autoRecognition: "Y",
        },
        {
          englishName: "Scots",
          chineseName: "è‹æ ¼å…°ç›–å°”è¯­",
          code: "gd",
          autoRecognition: "N",
        },
        {
          englishName: "Galician",
          chineseName: "åŠ åˆ©è¥¿äºšè¯­",
          code: "gl",
          autoRecognition: "Y",
        },
        {
          englishName: "Gujarati",
          chineseName: "å¤å‰æ‹‰ç‰¹è¯­",
          code: "gu",
          autoRecognition: "Y",
        },
        {
          englishName: "Hausa",
          chineseName: "è±ªè¨è¯­",
          code: "ha",
          autoRecognition: "N",
        },
        {
          englishName: "Hawaiian",
          chineseName: "å¤å¨å¤·è¯­",
          code: "haw",
          autoRecognition: "N",
        },
        {
          englishName: "Hebrew",
          chineseName: "å¸Œä¼¯æ¥è¯­",
          code: "he",
          autoRecognition: "Y",
        },
        {
          englishName: "Hindi",
          chineseName: "å°åœ°è¯­",
          code: "hi",
          autoRecognition: "Y",
        },
        {
          englishName: "Croatian",
          chineseName: "å…‹ç½—åœ°äºšè¯­",
          code: "hr",
          autoRecognition: "Y",
        },
        {
          englishName: "Haitian",
          chineseName: "æµ·åœ°å…‹é‡Œå¥¥å°”è¯­",
          code: "ht",
          autoRecognition: "Y",
        },
        {
          englishName: "Hungarian",
          chineseName: "åŒˆç‰™åˆ©è¯­",
          code: "hu",
          autoRecognition: "Y",
        },
        {
          englishName: "Armenian",
          chineseName: "äºšç¾å°¼äºšè¯­",
          code: "hy",
          autoRecognition: "N",
        },
        {
          englishName: "Igbo",
          chineseName: "ä¼Šåšè¯­",
          code: "ig",
          autoRecognition: "N",
        },
        {
          englishName: "Icelandic",
          chineseName: "å†°å²›è¯­",
          code: "is",
          autoRecognition: "Y",
        },
        {
          englishName: "Javanese",
          chineseName: "çˆªå“‡è¯­",
          code: "jw",
          autoRecognition: "N",
        },
        {
          englishName: "Georgian",
          chineseName: "æ ¼é²å‰äºšè¯­",
          code: "ka",
          autoRecognition: "N",
        },
        {
          englishName: "Kazakh",
          chineseName: "å“ˆè¨å…‹è¯­",
          code: "kk",
          autoRecognition: "Y",
        },
        {
          englishName: "Khmer",
          chineseName: "é«˜æ£‰è¯­",
          code: "km",
          autoRecognition: "Y",
        },
        {
          englishName: "Kannada",
          chineseName: "å¡çº³è¾¾è¯­",
          code: "kn",
          autoRecognition: "Y",
        },
        {
          englishName: "Kurdish",
          chineseName: "åº“å°”å¾·è¯­",
          code: "ku",
          autoRecognition: "N",
        },
        {
          englishName: "Kyrgyz",
          chineseName: "æŸ¯å°”å…‹å­œè¯­",
          code: "ky",
          autoRecognition: "Y",
        },
        {
          englishName: "Latin",
          chineseName: "æ‹‰ä¸è¯­",
          code: "la",
          autoRecognition: "Y",
        },
        {
          englishName: "Luxembourgish",
          chineseName: "å¢æ£®å ¡è¯­",
          code: "lb",
          autoRecognition: "Y",
        },
        {
          englishName: "Lao",
          chineseName: "è€æŒè¯­",
          code: "lo",
          autoRecognition: "Y",
        },
        {
          englishName: "Lithuanian",
          chineseName: "ç«‹é™¶å®›è¯­",
          code: "lt",
          autoRecognition: "Y",
        },
        {
          englishName: "Latvian",
          chineseName: "æ‹‰è„±ç»´äºšè¯­",
          code: "lv",
          autoRecognition: "Y",
        },
        {
          englishName: "Malagasy",
          chineseName: "é©¬å°”åŠ ä»€è¯­",
          code: "mg",
          autoRecognition: "N",
        },
        {
          englishName: "Maori",
          chineseName: "æ¯›åˆ©è¯­",
          code: "mi",
          autoRecognition: "N",
        },
        {
          englishName: "Macedonian",
          chineseName: "é©¬å…¶é¡¿è¯­",
          code: "mk",
          autoRecognition: "Y",
        },
        {
          englishName: "Malayalam",
          chineseName: "é©¬æ‹‰é›…æ‹‰å§†è¯­",
          code: "ml",
          autoRecognition: "Y",
        },
        {
          englishName: "Mongolian",
          chineseName: "è’™å¤è¯­",
          code: "mn",
          autoRecognition: "Y",
        },
        {
          englishName: "Marathi",
          chineseName: "é©¬æ‹‰åœ°è¯­",
          code: "mr",
          autoRecognition: "Y",
        },
        {
          englishName: "Malay",
          chineseName: "é©¬æ¥è¯­",
          code: "ms",
          autoRecognition: "Y",
        },
        {
          englishName: "Maltese",
          chineseName: "é©¬è€³ä»–è¯­",
          code: "mt",
          autoRecognition: "Y",
        },
        {
          englishName: "Hmong",
          chineseName: "ç™½è‹—è¯­",
          code: "mww",
          autoRecognition: "N",
        },
        {
          englishName: "Myanmar (Burmese)",
          chineseName: "ç¼…ç”¸è¯­",
          code: "my",
          autoRecognition: "Y",
        },
        {
          englishName: "Nepali",
          chineseName: "å°¼æ³Šå°”è¯­",
          code: "ne",
          autoRecognition: "Y",
        },
        {
          englishName: "Norwegian",
          chineseName: "æŒªå¨è¯­",
          code: "no",
          autoRecognition: "Y",
        },
        {
          englishName: "Nyanja (Chichewa)",
          chineseName: "é½åˆ‡ç“¦è¯­",
          code: "ny",
          autoRecognition: "N",
        },
        {
          englishName: "QuerÃ©taro Otomi",
          chineseName: "å…‹é›·å¡”ç½—å¥¥æ‰˜ç±³è¯­",
          code: "otq",
          autoRecognition: "N",
        },
        {
          englishName: "Punjabi",
          chineseName: "æ—é®æ™®è¯­",
          code: "pa",
          autoRecognition: "Y",
        },
        {
          englishName: "Polish",
          chineseName: "æ³¢å…°è¯­",
          code: "pl",
          autoRecognition: "Y",
        },
        {
          englishName: "Pashto",
          chineseName: "æ™®ä»€å›¾è¯­",
          code: "ps",
          autoRecognition: "Y",
        },
        {
          englishName: "Romanian",
          chineseName: "ç½—é©¬å°¼äºšè¯­",
          code: "ro",
          autoRecognition: "Y",
        },
        {
          englishName: "Sindhi",
          chineseName: "ä¿¡å¾·è¯­",
          code: "sd",
          autoRecognition: "Y",
        },
        {
          englishName: "Sinhala (Sinhalese)",
          chineseName: "åƒ§ä¼½ç½—è¯­",
          code: "si",
          autoRecognition: "N",
        },
        {
          englishName: "Slovak",
          chineseName: "æ–¯æ´›ä¼å…‹è¯­",
          code: "sk",
          autoRecognition: "Y",
        },
        {
          englishName: "Slovenian",
          chineseName: "æ–¯æ´›æ–‡å°¼äºšè¯­",
          code: "sl",
          autoRecognition: "Y",
        },
        {
          englishName: "Samoan",
          chineseName: "è¨æ‘©äºšè¯­",
          code: "sm",
          autoRecognition: "N",
        },
        {
          englishName: "Shona",
          chineseName: "ä¿®çº³è¯­",
          code: "sn",
          autoRecognition: "N",
        },
        {
          englishName: "Somali",
          chineseName: "ç´¢é©¬é‡Œè¯­",
          code: "so",
          autoRecognition: "Y",
        },
        {
          englishName: "Albanian",
          chineseName: "é˜¿å°”å·´å°¼äºšè¯­",
          code: "sq",
          autoRecognition: "Y",
        },
        {
          englishName: "Serbian (Cyrillic)",
          chineseName: "å¡å°”ç»´äºšè¯­(è¥¿é‡Œå°”æ–‡)",
          code: "sr-Cyrl",
          autoRecognition: "Y",
        },
        {
          englishName: "Serbian (Latin)",
          chineseName: "å¡å°”ç»´äºšè¯­(æ‹‰ä¸æ–‡)",
          code: "sr-Latn",
          autoRecognition: "Y",
        },
        {
          englishName: "Sesotho",
          chineseName: "å¡ç´¢æ‰˜è¯­",
          code: "st",
          autoRecognition: "N",
        },
        {
          englishName: "Sundanese",
          chineseName: "å·½ä»–è¯­",
          code: "su",
          autoRecognition: "Y",
        },
        {
          englishName: "Swedish",
          chineseName: "ç‘å…¸è¯­",
          code: "sv",
          autoRecognition: "Y",
        },
        {
          englishName: "Kiswahili",
          chineseName: "æ–¯ç“¦å¸Œé‡Œè¯­",
          code: "sw",
          autoRecognition: "Y",
        },
      ],
      videos: [
        require("@/assets/video/guohua.mp4"), // ä½¿ç”¨requireç¡®ä¿è·¯å¾„è¢«æ­£ç¡®è§£æ
        require("@/assets/video/hanfu.mp4"),
        require("@/assets/video/taoci.mp4"),
        require("@/assets/video/zhongyi.mp4"),
      ],
      nowColor: {
        name: "ä¸­å›½è‰²",
        C: 0,
        M: 0,
        Y: 0,
        K: 0,
        R: 255,
        G: 255,
        B: 255,
        code: "",
        pinyin: "ZHONGGUOSE",
      },
      colors: [
        {
          name: "æš—ç‰ç´«",
          C: 35,
          M: 94,
          Y: 77,
          K: 53,
          R: 255,
          G: 255,
          B: 255,
          code: "5c2223",
          pinyin: "ANYUZI",
        },
        {
          name: "ç‰¡ä¸¹ç²‰çº¢",
          C: 0,
          M: 49,
          Y: 27,
          K: 0,
          R: 238,
          G: 162,
          B: 164,
          code: "eea2a4",
          pinyin: "MUDANFENHONG",
        },
        {
          name: "æ —ç´«",
          C: 35,
          M: 100,
          Y: 85,
          K: 54,
          R: 90,
          G: 25,
          B: 27,
          code: "5a191b",
          pinyin: "LIZI",
        },
        {
          name: "é¦™å¶çº¢",
          C: 0,
          M: 65,
          Y: 38,
          K: 0,
          R: 240,
          G: 124,
          B: 130,
          code: "f07c82",
          pinyin: "XIANGYEHONG",
        },
        {
          name: "è‘¡è„é…±ç´«",
          C: 35,
          M: 100,
          Y: 80,
          K: 54,
          R: 90,
          G: 18,
          B: 22,
          code: "5a1216",
          pinyin: "PUTAOJIANGZI",
        },
        {
          name: "è‰³çº¢",
          C: 0,
          M: 77,
          Y: 49,
          K: 0,
          R: 237,
          G: 90,
          B: 101,
          code: "ed5a65",
          pinyin: "YANHONG",
        },
        {
          name: "ç‰çº¢",
          C: 13,
          M: 83,
          Y: 62,
          K: 3,
          R: 192,
          G: 72,
          B: 81,
          code: "c04851",
          pinyin: "YUHONG",
        },
        {
          name: "èŒ¶èŠ±çº¢",
          C: 0,
          M: 84,
          Y: 60,
          K: 0,
          R: 238,
          G: 63,
          B: 77,
          code: "ee3f4d",
          pinyin: "CHAHUAHONG",
        },
        {
          name: "é«˜ç²±çº¢",
          C: 11,
          M: 93,
          Y: 77,
          K: 0,
          R: 192,
          G: 44,
          B: 56,
          code: "c02c38",
          pinyin: "GAOLIANGHONG",
        },
        {
          name: "æ»¡æ±Ÿçº¢",
          C: 22,
          M: 76,
          Y: 54,
          K: 12,
          R: 167,
          G: 83,
          B: 90,
          code: "a7535a",
          pinyin: "MANJIANGHONG",
        },
        {
          name: "é¼ é¼»çº¢",
          C: 5,
          M: 38,
          Y: 20,
          K: 0,
          R: 27,
          G: 180,
          B: 184,
          code: "e3b4b8",
          pinyin: "SHUBIHONG",
        },
        {
          name: "åˆæ¬¢çº¢",
          C: 0,
          M: 50,
          Y: 23,
          K: 0,
          R: 40,
          G: 161,
          B: 181,
          code: "f0a1a8",
          pinyin: "HEHUANHONG",
        },
        {
          name: "æ˜¥æ¢…çº¢",
          C: 0,
          M: 56,
          Y: 27,
          K: 0,
          R: 41,
          G: 147,
          B: 156,
          code: "f19397",
          pinyin: "CHUNMEIHONG",
        },
        {
          name: "æ«å¶çº¢",
          C: 10,
          M: 96,
          Y: 82,
          K: 8,
          R: 194,
          G: 31,
          B: 48,
          code: "c21f30",
          pinyin: "FENGYEHONG",
        },
        {
          name: "ä¸¹ç´«çº¢",
          C: 7,
          M: 79,
          Y: 78,
          K: 0,
          R: 210,
          G: 86,
          B: 140,
          code: "d2568c",
          pinyin: "DANZIHONG",
        },
        {
          name: "é¼ èƒŒç°",
          C: 41,
          M: 64,
          Y: 44,
          K: 36,
          R: 115,
          G: 87,
          B: 92,
          code: "73575c",
          pinyin: "SHUBEIHUI",
        },
        {
          name: "èŠè¯è€•çº¢",
          C: 0,
          M: 50,
          Y: 16,
          K: 0,
          R: 35,
          G: 160,
          B: 179,
          code: "eba0b3",
          pinyin: "SHAOYAOGENGHONG",
        },
        {
          name: "å“çº¢",
          C: 0,
          M: 86,
          Y: 30,
          K: 0,
          R: 239,
          G: 52,
          B: 115,
          code: "ef3473",
          pinyin: "PINHONG",
        },
        {
          name: "å¤é¼ç°",
          C: 63,
          M: 74,
          Y: 52,
          K: 70,
          R: 54,
          G: 41,
          B: 47,
          code: "36292f",
          pinyin: "GUDINGHUI",
        },
        {
          name: "é¾™é¡»çº¢",
          C: 11,
          M: 97,
          Y: 10,
          K: 0,
          R: 204,
          G: 85,
          B: 149,
          code: "cc5595",
          pinyin: "LONGXVHONG",
        },
        {
          name: "ä¹Œæ¢…ç´«",
          C: 81,
          M: 87,
          Y: 54,
          K: 84,
          R: 30,
          G: 19,
          B: 29,
          code: "1e131d",
          pinyin: "WUMEIZI",
        },
        {
          name: "æ¡”æ¢—ç´«",
          C: 54,
          M: 89,
          Y: 12,
          K: 1,
          R: 19,
          G: 60,
          B: 133,
          code: "813c85",
          pinyin: "JIEGENGZI",
        },
        {
          name: "å‡¤ä¿¡ç´«",
          C: 21,
          M: 37,
          Y: 12,
          K: 0,
          R: 200,
          G: 173,
          B: 196,
          code: "c8adc4",
          pinyin: "FENGXINZI",
        },
        {
          name: "è•ˆç´«",
          C: 56,
          M: 72,
          Y: 15,
          K: 1,
          R: 129,
          G: 92,
          B: 148,
          code: "815c94",
          pinyin: "XUNZI",
        },
        {
          name: "æ™¶çŸ³ç´«",
          C: 98,
          M: 93,
          Y: 48,
          K: 73,
          R: 31,
          G: 32,
          B: 64,
          code: "1f2040",
          pinyin: "JINGSHIZI",
        },
        {
          name: "è¿œå±±ç´«",
          C: 23,
          M: 18,
          Y: 12,
          K: 1,
          R: 204,
          G: 204,
          B: 214,
          code: "ccccd6",
          pinyin: "YUANSHANZI",
        },
        {
          name: "ç‡•é¢”è“",
          C: 100,
          M: 86,
          Y: 54,
          K: 78,
          R: 19,
          G: 24,
          B: 36,
          code: "131824",
          pinyin: "YANHANLAN",
        },
        {
          name: "é’¢é’",
          C: 100,
          M: 82,
          Y: 51,
          K: 64,
          R: 20,
          G: 35,
          B: 52,
          code: "142334",
          pinyin: "GANGQING",
        },
        {
          name: "æµ·æ¶›è“",
          C: 100,
          M: 67,
          Y: 36,
          K: 3,
          R: 21,
          G: 85,
          B: 154,
          code: "15559a",
          pinyin: "HAITAOLAN",
        },
        {
          name: "èŠ±é’",
          C: 95,
          M: 45,
          Y: 10,
          K: 1,
          R: 35,
          G: 118,
          B: 183,
          code: "2376b7",
          pinyin: "HUAQING",
        },
        {
          name: "æ˜Ÿè“",
          C: 53,
          M: 19,
          Y: 15,
          K: 1,
          R: 147,
          G: 181,
          B: 207,
          code: "93b5cf",
          pinyin: "XINGLAN",
        },
        {
          name: "äº‘æ°´è“",
          C: 35,
          M: 13,
          Y: 13,
          K: 0,
          R: 186,
          G: 204,
          B: 217,
          code: "baccd9",
          pinyin: "YUNSHUILAN",
        },
        {
          name: "ç‰µç‰›èŠ±è“",
          C: 98,
          M: 42,
          Y: 16,
          K: 3,
          R: 17,
          G: 119,
          B: 176,
          code: "1177b0",
          pinyin: "QIANNIUHUALAN",
        },
        {
          name: "äº•å¤©è“",
          C: 32,
          M: 8,
          Y: 13,
          K: 0,
          R: 195,
          G: 215,
          B: 223,
          code: "c3d7df",
          pinyin: "JINGTIANLAN",
        },
        {
          name: "é‡‰è“",
          C: 96,
          M: 34,
          Y: 18,
          K: 4,
          R: 3,
          G: 129,
          B: 181,
          code: "1781b5",
          pinyin: "YOULAN",
        },
        {
          name: "äº‘å³°ç™½",
          C: 21,
          M: 6,
          Y: 10,
          K: 0,
          R: 216,
          G: 227,
          B: 231,
          code: "d8e3e7",
          pinyin: "YUNFENGBAI",
        },
        {
          name: "è‹è“",
          C: 100,
          M: 52,
          Y: 46,
          K: 43,
          R: 19,
          G: 72,
          B: 87,
          code: "134857",
          pinyin: "CANGLAN",
        },
        {
          name: "å¤äº‘ç°",
          C: 65,
          M: 40,
          Y: 44,
          K: 26,
          R: 97,
          G: 113,
          B: 114,
          code: "617172",
          pinyin: "XIAYUNHUI",
        },
        {
          name: "çŸ³ç»¿",
          C: 78,
          M: 36,
          Y: 0,
          K: 0,
          R: 87,
          G: 195,
          B: 194,
          code: "57c3c2",
          pinyin: "SHILV",
        },
        {
          name: "ç«¹ç»¿",
          C: 96,
          M: 0,
          Y: 64,
          K: 0,
          R: 26,
          G: 167,
          B: 132,
          code: "1ba784",
          pinyin: "ZHULV",
        },
        {
          name: "æ·±æµ·ç»¿",
          C: 98,
          M: 46,
          Y: 73,
          K: 63,
          R: 6,
          G: 59,
          B: 50,
          code: "1a3b32",
          pinyin: "SHENHAILV",
        },
        {
          name: "é£æ³‰ç»¿",
          C: 82,
          M: 32,
          Y: 60,
          K: 20,
          R: 73,
          G: 117,
          B: 104,
          code: "497568",
          pinyin: "FEIQUANLV",
        },
        {
          name: "è›™ç»¿",
          C: 86,
          M: 0,
          Y: 63,
          K: 0,
          R: 69,
          G: 183,
          B: 135,
          code: "45b787",
          pinyin: "WALV",
        },
        {
          name: "è‘±ç»¿",
          C: 90,
          M: 7,
          Y: 73,
          K: 0,
          R: 64,
          G: 160,
          B: 112,
          code: "40a070",
          pinyin: "CONGLV",
        },
        {
          name: "è·å¶ç»¿",
          C: 100,
          M: 31,
          Y: 91,
          K: 25,
          R: 26,
          G: 104,
          B: 64,
          code: "1a6840",
          pinyin: "HEYELV",
        },
        {
          name: "ç‰ç°ªç»¿",
          C: 49,
          M: 5,
          Y: 37,
          K: 0,
          R: 164,
          G: 202,
          B: 182,
          code: "a4cab6",
          pinyin: "YUZANLV",
        },
        {
          name: "èŸ¾ç»¿",
          C: 93,
          M: 24,
          Y: 76,
          K: 2,
          R: 60,
          G: 149,
          B: 102,
          code: "3c9566",
          pinyin: "CHANLV",
        },
        {
          name: "æ¯›ç»¿",
          C: 75,
          M: 0,
          Y: 61,
          K: 0,
          R: 102,
          G: 193,
          B: 140,
          code: "66c18c",
          pinyin: "MAOLV",
        },
        {
          name: "ç‹¼çƒŸç°",
          C: 62,
          M: 43,
          Y: 52,
          K: 34,
          R: 93,
          G: 101,
          B: 95,
          code: "5d655f",
          pinyin: "LANGYANHUI",
        },
        {
          name: "ç‰é«“ç»¿",
          C: 89,
          M: 0,
          Y: 96,
          K: 0,
          R: 65,
          G: 179,
          B: 73,
          code: "41b349",
          pinyin: "YUSUILV",
        },
        {
          name: "å§šé»„",
          C: 28,
          M: 4,
          Y: 44,
          K: 0,
          R: 208,
          G: 22,
          B: 170,
          code: "d0deaa",
          pinyin: "YAOHUANG",
        },
        {
          name: "ä½›æ‰‹é»„",
          C: 1,
          M: 18,
          Y: 94,
          K: 0,
          R: 254,
          G: 215,
          B: 26,
          code: "fed71a",
          pinyin: "FOSHOUHUANG",
        },
        {
          name: "è‰é»„",
          C: 17,
          M: 27,
          Y: 94,
          K: 4,
          R: 210,
          G: 180,
          B: 44,
          code: "d2b42c",
          pinyin: "CAOHUANG",
        },
        {
          name: "æ½­æ°´ç»¿",
          C: 48,
          M: 48,
          Y: 100,
          K: 45,
          R: 100,
          G: 88,
          B: 34,
          code: "645822",
          pinyin: "TANSHUILV",
        },
        {
          name: "æŸ æª¬é»„",
          C: 0,
          M: 20,
          Y: 87,
          K: 0,
          R: 252,
          G: 211,
          B: 55,
          code: "fcd337",
          pinyin: "NINGMENGHUANG",
        },
        {
          name: "æœˆç°",
          C: 28,
          M: 26,
          Y: 45,
          K: 7,
          R: 183,
          G: 174,
          B: 143,
          code: "b7ae8f",
          pinyin: "YUEHUI",
        },
        {
          name: "ä¹³é¸­é»„",
          C: 0,
          M: 26,
          Y: 94,
          K: 0,
          R: 255,
          G: 201,
          B: 22,
          code: "ffc90c",
          pinyin: "RUYAHUANG",
        },
        {
          name: "æ €å­é»„",
          C: 3,
          M: 36,
          Y: 99,
          K: 0,
          R: 235,
          G: 177,
          B: 13,
          code: "ebb10d",
          pinyin: "ZHIZIHUANG",
        },
        {
          name: "è²å­ç™½",
          C: 11,
          M: 18,
          Y: 39,
          K: 1,
          R: 229,
          G: 211,
          B: 170,
          code: "e5d3aa",
          pinyin: "LIANZIBAI",
        },
        {
          name: "ç‡•ç¾½ç°",
          C: 47,
          M: 47,
          Y: 65,
          K: 42,
          R: 104,
          G: 94,
          B: 72,
          code: "685e48",
          pinyin: "YANYUHUI",
        },
        {
          name: "æ·¡è‚‰è‰²",
          C: 1,
          M: 15,
          Y: 38,
          K: 0,
          R: 248,
          G: 224,
          B: 176,
          code: "f8e0b0",
          pinyin: "DANROUSE",
        },
        {
          name: "æ¦´è¼é»„",
          C: 0,
          M: 44,
          Y: 84,
          K: 0,
          R: 249,
          G: 166,
          B: 51,
          code: "f9a633",
          pinyin: "LIUEHUANG",
        },
        {
          name: "åŒ—ç“œé»„",
          C: 0,
          M: 56,
          Y: 87,
          K: 0,
          R: 252,
          G: 140,
          B: 35,
          code: "fc8c23",
          pinyin: "BEIGUANHUANG",
        },
        {
          name: "é©¼è‰²",
          C: 37,
          M: 65,
          Y: 84,
          K: 49,
          R: 102,
          G: 70,
          B: 42,
          code: "66462a",
          pinyin: "TUOSE",
        },
        {
          name: "é¹¿çš®è¤",
          C: 7,
          M: 52,
          Y: 71,
          K: 1,
          R: 217,
          G: 145,
          B: 86,
          code: "d99156",
          pinyin: "LUPIHE",
        },
        {
          name: "éº‚æ£•",
          C: 0,
          M: 64,
          Y: 93,
          K: 0,
          R: 222,
          G: 118,
          B: 34,
          code: "de7622",
          pinyin: "JIZONG",
        },
        {
          name: "åˆæ¡ƒç²‰çº¢",
          C: 0,
          M: 19,
          Y: 19,
          K: 0,
          R: 246,
          G: 220,
          B: 206,
          code: "f6dcce",
          pinyin: "CHUTAOFENHONG",
        },
        {
          name: "æ™¨æ›¦çº¢",
          C: 0,
          M: 58,
          Y: 67,
          K: 0,
          R: 234,
          G: 137,
          B: 88,
          code: "ea8958",
          pinyin: "CHENXIHONG",
        },
        {
          name: "è—•è·",
          C: 2,
          M: 31,
          Y: 31,
          K: 0,
          R: 237,
          G: 195,
          B: 134,
          code: "edc3ae",
          pinyin: "OUHE",
        },
        {
          name: "ç»€çº¢",
          C: 20,
          M: 72,
          Y: 96,
          K: 9,
          R: 166,
          G: 82,
          B: 44,
          code: "a6522c",
          pinyin: "GANHONG",
        },
        {
          name: "ç­çš®ç´«",
          C: 30,
          M: 89,
          Y: 100,
          K: 39,
          R: 155,
          G: 46,
          B: 18,
          code: "732e12",
          pinyin: "SUNPIZI",
        },
        {
          name: "é¾™ç›é±¼çº¢",
          C: 0,
          M: 72,
          Y: 82,
          K: 0,
          R: 239,
          G: 99,
          B: 43,
          code: "ef632b",
          pinyin: "LONGJINGYUHONG",
        },
        {
          name: "è²‚ç´«",
          C: 36,
          M: 81,
          Y: 64,
          K: 54,
          R: 93,
          G: 49,
          B: 49,
          code: "5d3131",
          pinyin: "DIAOZI",
        },
        {
          name: "æ·¡è½çº¢",
          C: 0,
          M: 81,
          Y: 66,
          K: 0,
          R: 237,
          G: 72,
          B: 69,
          code: "ed4845",
          pinyin: "DANSHUHONG",
        },
        {
          name: "é¹¤é¡¶çº¢",
          C: 0,
          M: 92,
          Y: 95,
          K: 0,
          R: 212,
          G: 37,
          B: 23,
          code: "d42517",
          pinyin: "HEDINGHONG",
        },
        {
          name: "çŸ³æ¿ç°",
          C: 39,
          M: 60,
          Y: 58,
          K: 51,
          R: 98,
          G: 73,
          B: 65,
          code: "624941",
          pinyin: "SHIBANHUI",
        },
        {
          name: "èŸ¹è¯çº¢",
          C: 18,
          M: 80,
          Y: 92,
          K: 7,
          R: 177,
          G: 75,
          B: 40,
          code: "b14b28",
          pinyin: "XIEAOHONG",
        },
        {
          name: "é¾ŸèƒŒé»„",
          C: 35,
          M: 47,
          Y: 71,
          K: 33,
          R: 130,
          G: 107,
          B: 72,
          code: "826b48",
          pinyin: "GUIBEIHUANG",
        },
        {
          name: "é“…ç°",
          C: 28,
          M: 5,
          Y: 30,
          K: 5,
          R: 187,
          G: 181,
          B: 172,
          code: "bbb5ac",
          pinyin: "QIANHUI",
        },
        {
          name: "é±¼è‚šç™½",
          C: 4,
          M: 4,
          Y: 0,
          K: 0,
          R: 247,
          G: 244,
          B: 237,
          code: "f7f4ed",
          pinyin: "YUDUBAI",
        },
        {
          name: "è›Ÿé’",
          C: 35,
          M: 44,
          Y: 80,
          K: 30,
          R: 135,
          G: 114,
          B: 62,
          code: "87723e",
          pinyin: "JIAOQING",
        },
        {
          name: "å°˜ç°",
          C: 26,
          M: 37,
          Y: 51,
          K: 10,
          R: 182,
          G: 164,
          B: 118,
          code: "b6a476",
          pinyin: "CHENHUI",
        },
      ],
      provinceColors: {
        åŒ—äº¬å¸‚: "#DAF7A6",
        å¤©æ´¥å¸‚: "#DAF7A6",
        æ²³åŒ—çœ: "#DAF7A6",
        å±±è¥¿çœ: "#FFC300",
        å†…è’™å¤è‡ªæ²»åŒº: "#FF5733",
        è¾½å®çœ: "#33FFF6",
        å‰æ—çœ: "#33FFF6",
        é»‘é¾™æ±Ÿçœ: "#33FFF6",
        ä¸Šæµ·å¸‚: "#DAF7A6",
        æ±Ÿè‹çœ: "#DAF7A6",
        æµ™æ±Ÿçœ: "#DAF7A6",
        å®‰å¾½çœ: "#FFC300",
        ç¦å»ºçœ: "#DAF7A6",
        æ±Ÿè¥¿çœ: "#FFC300",
        å±±ä¸œçœ: "#DAF7A6",
        æ²³å—çœ: "#FFC300",
        æ¹–åŒ—çœ: "#FFC300",
        æ¹–å—çœ: "#FFC300",
        å¹¿ä¸œçœ: "#DAF7A6",
        å¹¿è¥¿å£®æ—è‡ªæ²»åŒº: "#FF5733",
        æµ·å—çœ: "#DAF7A6",
        é‡åº†å¸‚: "#FF5733",
        å››å·çœ: "#FF5733",
        è´µå·çœ: "#FF5733",
        äº‘å—çœ: "#FF5733",
        è¥¿è—è‡ªæ²»åŒº: "#FF5733",
        é™•è¥¿çœ: "#FF5733",
        ç”˜è‚ƒçœ: "#FF5733",
        é’æµ·çœ: "#FF5733",
        å®å¤å›æ—è‡ªæ²»åŒº: "#FF5733",
        æ–°ç–†ç»´å¾å°”è‡ªæ²»åŒº: "#FF5733",
      },
      chats: [],

      historyes: {
      
      },
    };
  },
  computed: {
    iconClass() {
      return {
        "icon-color-empty": this.isTextEmpty,
        "icon-color-filled": !this.isTextEmpty,
      };
    },
    limitTip() {
      if (this.textarea.length > 9500) {
        return true;
      } else {
        return false;
      }
    },
    isTextEmpty() {
      // ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼åˆ¤æ–­å­—ç¬¦ä¸²æ˜¯å¦ä¸ºç©ºæˆ–å…¨ä¸ºç©ºæ ¼
      let text = /^\s*$/.test(this.textarea);
      if (text === true) {
        if (this.uploadImgUrl === "") {
          return true;
        } else {
          return false;
        }
      } else {
        return false;
      }
    },
  },
  created() {
    // é¡µé¢åˆ›å»ºæ—¶ï¼Œä» sessionStorage åŠ è½½æ•°æ®
    this.topRightOffset =
      parseFloat(sessionStorage.getItem("topRightOffset")) || 0;
    this.topLeftOffset =
      parseFloat(sessionStorage.getItem("topLeftOffset")) || 0;
    this.showBtn = sessionStorage.getItem("showBtn") === "true"; // æ¢å¤ showBtn çŠ¶æ€
  },
  async mounted() {
    try {
      await this.loadBMapGL();
      await this.initMap(); // ç¡®ä¿é¡ºåºæ‰§è¡Œ
    } catch (error) {
      console.error("åœ°å›¾åˆå§‹åŒ–å¤±è´¥:", error);
      this.$message.error('åœ°å›¾åˆå§‹åŒ–å¤±è´¥,è¯·åˆ·æ–°é‡è¯•ï¼')
      // å¯åœ¨æ­¤å¤„æ·»åŠ é”™è¯¯æç¤º
    }

    this.setupMouseEvents();

    const chatContainer = this.$refs.cultureBox;
    if (chatContainer) {
      // å°†æ»šåŠ¨æ¡ä½ç½®è®¾ç½®åˆ°å®¹å™¨çš„æœ€åº•éƒ¨
      chatContainer.scrollTop = chatContainer.scrollHeight;
    }

    // è·å– SpeechRecognition æ„é€ å‡½æ•°ï¼Œå…¼å®¹ä¸åŒæµè§ˆå™¨
    const SpeechRecognition =
      window.SpeechRecognition || window.webkitSpeechRecognition;
    if (SpeechRecognition) {
      // åˆ›å»º SpeechRecognition å®ä¾‹
      this.recognition = new SpeechRecognition();
      // è®¾ç½®è¯†åˆ«è¯­è¨€ä¸ºä¸­æ–‡
      this.recognition.lang = "zh-CN";
      // è®¾ç½®è¿ç»­è¯†åˆ«
      this.recognition.continuous = true;
      // è¿”å›ä¸´æ—¶è¯†åˆ«ç»“æœ
      this.recognition.interimResults = true;
      // è·å–æ›´å¤šå¯èƒ½çš„è¯†åˆ«ç»“æœ
      this.recognition.maxAlternatives = 3;

      // è®°å½•æœ€ç»ˆçš„æ–‡æœ¬å†…å®¹
      let finalText = "";
      // è®°å½•ä¸´æ—¶æ–‡æœ¬å†…å®¹
      let interimText = "";
      let text = this.textarea;

      this.recognition.onresult = (event) => {
        // é‡ç½®ä¸´æ—¶æ–‡æœ¬
        interimText = "";
        for (let i = event.resultIndex; i < event.results.length; i++) {
          const result = event.results[i];
          if (result.isFinal) {
            // å¤„ç†æœ€ç»ˆç»“æœ
            const transcript = result[0].transcript;
            finalText += transcript;
            this.textarea = finalText;
            // console.log(this.textarea + 'if');
          } else {
            // å¤„ç†ä¸´æ—¶ç»“æœ
            const transcript = result[0].transcript;
            interimText = transcript;
            // æ˜¾ç¤ºä¸´æ—¶ç»“æœï¼Œä¸´æ—¶ç»“æœè¦†ç›–ä¹‹å‰çš„ä¸´æ—¶ç»“æœ
            // console.log(this.textarea);

            this.textarea = text + finalText + interimText;
          }
        }
      };
    } else {
      // æµè§ˆå™¨ä¸æ”¯æŒè¯­éŸ³è¯†åˆ«åŠŸèƒ½æ—¶ï¼Œåœ¨æ§åˆ¶å°è¾“å‡ºæç¤ºä¿¡æ¯
      console.log("æµè§ˆå™¨ä¸æ”¯æŒè¯­éŸ³è¯†åˆ«åŠŸèƒ½");
    }
    const md = new MarkdownIt({
      html: true, // åœ¨æºç ä¸­å¯ç”¨ HTML æ ‡ç­¾
      breaks: true, // è½¬æ¢æ®µè½é‡Œçš„ '\n' åˆ° <br>ã€‚
      // æ–°å¢æ ‡é¢˜æ¸²æŸ“ç›¸å…³é…ç½®ï¼Œå¯æ ¹æ®éœ€æ±‚è°ƒæ•´
      linkify: true,
      typographer: true,
      // å¯è®¾ç½®æ ‡é¢˜æ¸²æŸ“æ·±åº¦ç­‰
      heading: {
        lvl: 1,
        max: 6,
      },
    });
    this.md = md;
    if (this.$store.state.token !== "") {
      this.getHistory();
    }
    // this.answerText=this.chats[this.chats.length-1].content;
  },
  beforeDestroy() {
    this.cleanupMouseEvents();
    if (this.map) this.map.destroy(); // æ˜ç¡®é”€æ¯åœ°å›¾å®ä¾‹
  },

  methods: {
    formatTooltip(val) {
      return val / 100;
    },
    dialogYes() {
      this.isShowDialog = false;
      this.$message.success("ä¿®æ”¹æˆåŠŸ");
    },
    setupMouseEvents() {
      const headerImage = this.$refs.headerImage;
      const firstBox = this.$refs.firstBox;

      firstBox.addEventListener("mousemove", this.handleMouseMove);
      firstBox.addEventListener("mouseleave", this.handleMouseLeave);
      firstBox.addEventListener("wheel", this.handleMouseWheel, {
        passive: false,
      });
      this.homeImg = headerImage;
      this.firstBox = firstBox;
    },
    cleanupMouseEvents() {
      const firstBox = this.$refs.firstBox;
      firstBox.removeEventListener("mousemove", this.handleMouseMove);
      firstBox.removeEventListener("mouseleave", this.handleMouseLeave);
      firstBox.removeEventListener("wheel", this.handleMouseWheel, {
        passive: false,
      });
    },
    handleMouseMove(e) {
      const mouseX = e.clientX / window.innerWidth;
      const mouseY = e.clientY / window.innerHeight;

      // è®¡ç®—åç§»é‡ï¼Œå¯ä»¥æ ¹æ®å®é™…éœ€æ±‚è°ƒæ•´ç³»æ•°ä»¥æ”¹å˜æ™ƒåŠ¨å¼ºåº¦
      const offsetX = -(mouseX - 0.5) * 20; // Xè½´ä¸Šçš„åç§»
      const offsetY = -(mouseY - 0.5) * 20; // Yè½´ä¸Šçš„åç§»

      // åº”ç”¨å˜æ¢
      this.homeImg.style.transform = `translate(-50%, -50%) translate(${offsetX}px, ${offsetY}px)`;
    },
    handleMouseLeave() {
      // é¼ æ ‡ç§»å‡ºçª—å£æ—¶é‡ç½®ä½ç½®
      this.homeImg.style.transform = "translate(-50%, -50%)";
    },
    handleMouseWheel(event) {
      if (this.isFaceBoxChange === false) {
        event.preventDefault(); // é˜»æ­¢é¡µé¢æ»šåŠ¨
      }
      if (event.deltaY > 0) {
        this.isFaceBoxChange = true;
        // æ‰§è¡Œå‘ä¸‹æ»šåŠ¨çš„æ“ä½œ
      } else if (event.deltaY < 0) {
        this.isFaceBoxChange = false;
        // æ‰§è¡Œå‘ä¸Šæ»šåŠ¨çš„æ“ä½œ
      }
    },
    changeColor(color) {
      this.nowColor = color;
    },
    adjustHeight() {
      const questionTextarea = this.$refs.questionTextarea;
      const maxHeight = 13;

      // å…ˆå°†é«˜åº¦è®¾ä¸ºautoï¼Œä»¥ä¾¿scrollHeightèƒ½æ­£ç¡®åæ˜ å½“å‰å†…å®¹é«˜åº¦
      questionTextarea.style.height = "auto";

      // è·å–ä¸Šä¸‹paddingå€¼
      const computedStyle = window.getComputedStyle(questionTextarea);
      const paddingTop = parseFloat(computedStyle.paddingTop);
      const paddingBottom = parseFloat(computedStyle.paddingBottom);
      const totalPadding = paddingTop + paddingBottom;
      // è®¡ç®—ä¸åŒ…å«paddingçš„å†…å®¹é«˜åº¦
      const contentHeight = questionTextarea.scrollHeight - totalPadding;

      const height = Math.min(
        (contentHeight / window.innerHeight) * 100 - 2.39568345323741,
        maxHeight
      );

      this.textareaHeight = height;
    },
    thirdNext() {
      this.topLeftOffset -= 100;
      this.topRightOffset += 100;

      // æ›´æ–° sessionStorage
      sessionStorage.setItem("topLeftOffset", this.topLeftOffset);
      sessionStorage.setItem("topRightOffset", this.topRightOffset);

      setTimeout(() => {
        this.showBtn = true;
        sessionStorage.setItem("showBtn", this.showBtn); // æ›´æ–° showBtn çŠ¶æ€åˆ° sessionStorage
      }, 480);
    },
    thirdLast() {
      this.topLeftOffset += 100;
      this.topRightOffset -= 100;

      // æ›´æ–° sessionStorage
      sessionStorage.setItem("topLeftOffset", this.topLeftOffset);
      sessionStorage.setItem("topRightOffset", this.topRightOffset);
      setTimeout(() => {
        this.showBtn = false;
        sessionStorage.setItem("showBtn", this.showBtn); // æ›´æ–° showBtn çŠ¶æ€åˆ° sessionStorage
      }, 100);
    },
    showVideo(index) {
      // if (this.nowVideo === this.videos[index]) return; // é¿å…é‡å¤èµ‹å€¼
      // console.log("old:" + this.nowVideo);
      this.isShowVideo = true;
      this.nowVideo = this.videos[index];
      // console.log("now:" + this.nowVideo);
    },
    changePage(name) {
      if (this.$store.state.token === "") {
        this.$bus.$emit("c-Login", "Login");
      } else {
        this.$bus.$emit("c-" + name, name);
      }
    },
    async loadBMapGL() {
      return new Promise((resolve, reject) => {
        if (window.BMapGL) {
          resolve();
          return;
        }

        const script = document.createElement("script");
        script.src =
          "https://api.map.baidu.com/api?type=webgl&v=1.0&ak=FKauit31L7Y5Fl6uJY66t9lP1zfsasYi&callback=initBMapGL";
        script.onerror = (err) => {
          reject(new Error("åŠ è½½ç™¾åº¦åœ°å›¾å¤±è´¥"));
        };

        window.initBMapGL = () => {
          resolve();
          delete window.initBMapGL;
        };

        document.head.appendChild(script);
      });
    },

    async initMap() {
      if (!window.BMapGL) throw new Error("BMapGLæœªåŠ è½½");

      const map = new BMapGL.Map("allmap");
      const point = new BMapGL.Point(103.834, 36.061);
      map.centerAndZoom(point, 5);
      map.enableScrollWheelZoom(true);

      // å°†åœ°ç†ç¼–ç å’Œç‚¹å‡»äº‹ä»¶ç§»åˆ°æ­¤å¤„
      const geoc = new BMapGL.Geocoder();
      map.addEventListener("click", (e) => {
        const pt = e.latlng;
        geoc.getLocation(pt, (rs) => {
          const addComp = rs.addressComponents;
          const cityName = addComp.city || addComp.district;
          this.cityName = cityName;
          // console.log("ç‚¹å‡»çš„æ˜¯" + this.cityName);

          if (cityName) this.highlightCity(cityName);
        });
      });

      this.map = map;

      // ç¡®ä¿åœ°å›¾åˆå§‹åŒ–åå†åŠ è½½æ•°æ®
      await this.getAllProvincesBoundaries(allProvinceBoundaries);
      await this.getAllCityBoundaries(allCityBoundaries);
    },
    getAllProvincesBoundaries(provinceData) {
      this.addFillLayer(provinceData);
    },

    addFillLayer(provinceData) {
      this.provinceFillLayer = new BMapGL.FillLayer({
        crs: "GCJ02",
        style: {
          fillColor: [
            "match",
            ["get", "name"],
            ...Object.entries(this.provinceColors).flatMap(([key, value]) => [
              key,
              value,
            ]),
            "#ccc",
          ],
          fillOpacity: 0.5,
          strokeWeight: 2,
          strokeColor: "black",
        },
        zIndex: 2,
      });

      this.provinceFillLayer.setData(provinceData);
      this.map.addNormalLayer(this.provinceFillLayer);
    },

    getAllCityBoundaries(cityData) {
      this.drawCityBoundaries(cityData);
    },

    drawCityBoundaries(data) {
      const lineLayer = new BMapGL.LineLayer({
        crs: "GCJ02",
        style: {
          lineWidth: 0.5,
          lineDasharray: [4, 4],
          lineCap: "butt",
          lineJoin: "miter",
          lineColor: "#000",
        },
        zIndex: 1,
      });
      lineLayer.setData(data);
      this.map.addNormalLayer(lineLayer);
    },

    highlightCity(cityName) {
      if (this.highlightedPolygon !== null) {
        this.map.clearOverlays();
      }

      const feature = this.cityData.features.find(
        (feature) => feature.properties.name === cityName
      );
      if (feature) {
        this.drawHighlightedCityBoundary(feature);
      }
      this.sendCity(cityName);
    },

    drawHighlightedCityBoundary(feature) {
      const coordinates = feature.geometry.coordinates;
      const polygons = coordinates.map((polygonCoords) =>
        polygonCoords[0].map((point) => new BMapGL.Point(point[0], point[1]))
      );

      polygons.forEach((points) => {
        this.highlightedPolygon = new BMapGL.Polygon(points, {
          strokeColor: "red",
          strokeWeight: 2,
          strokeOpacity: 1,
          fillColor: "rgba(255, 0, 0, 0.35)",
          fillOpacity: 0.35,
        });
        this.map.addOverlay(this.highlightedPolygon);
      });
    },
    sendImg() {
      this.answerBuffer = "";
      this.thinkingBuffer = "";
      this.thinkingCompleteMarkdown = "";
      this.answerCompleteMarkdown = "";
      let id = this.chats.length;
      const message = {
        id: id,
        type: "user",
        avatar: this.$store.state.avatarImageUrl,
        thinking: "",
        answer: "",
        content: "",
        imgUrl: this.uploadImgUrl,
        modules: [],
      };
      const aiMessage = {
        id: id + 1,
        type: "assistant",
        avatar:
          "https://oss-mtc.oss-cn-hangzhou.aliyuncs.com/2c927a761478a4a4248706b534bac146.gif",
        thinking: "",
        answer: "",
        content: "",
        imgUrl: "",
        modules: [],
      };
      const url = `${this.$baseUrl}agent/location`;
      const formData = new FormData();
      formData.append("file", this.selectedFile);
      // console.log(formData);

      this.chats.push(message);
      this.isThinking = true;
      this.fetchData(url, formData, aiMessage);

      this.textarea = "";
      this.transcript = "";
      this.textareaHeight = 3;
      this.uploadImgUrl = "";
    },
    handleEvent(event, aiMessage) {
      if (this.isThinking) {
        this.isThinking = false;
        this.chats.push(aiMessage);
      }

      const handleEventData = (completeMarkdownKey, bufferKey, eventName) => {
        // 1. å¤„ç†æ•°æ®
        const normalizedData = event.data
          .replace(/\\n/g, "\n")
          .replace(/\r?\n\r?\n/g, "\n\n");

        // 2. æ›´æ–°å®Œæ•´å†…å®¹
        this[completeMarkdownKey] += normalizedData;

        // 3. æ·»åŠ åˆ°ç¼“å†²åŒº
        this[bufferKey] += normalizedData;

        // 4. ä½¿ç”¨é˜²æŠ–è¿›è¡Œæ¸²æŸ“
        // clearTimeout(this.renderTimer);
        // this.renderTimer = setTimeout(() => {
        this.renderMarkdown(eventName);
        // }, 100); // 100ms çš„é˜²æŠ–æ—¶é—´

        // 5. å¼ºåˆ¶åœ¨ç‰¹å®šæ ‡è®°å¤„æ¸²æŸ“
        if (this.shouldForceRender(normalizedData)) {
          this.renderMarkdown(eventName);
        }
      };

      if (event.name === "æ€è€ƒ") {
        handleEventData("thinkingCompleteMarkdown", "thinkingBuffer", "æ€è€ƒ");
      } else if (event.name === "ç­”æ¡ˆ") {
        handleEventData("answerCompleteMarkdown", "answerBuffer", "ç­”æ¡ˆ");
      }
    },
    async fetchDataCommon(url, data, aiMessage, headers) {
      let isStreamComplete = false;
      try {
        const response = await fetch(url, {
          method: "POST",
          headers: {
            ...headers,
            token: `${this.$store.state.token}`,
          },
          body:
            typeof data === "object" && !(data instanceof FormData)
              ? JSON.stringify(data)
              : data,
        });
        if (!response.ok) {
          throw new Error(`HTTP error! status: ${response.status}`);
        }
        const reader = response.body.getReader();
        const decoder = new TextDecoder("utf-8");
        let buffer = "";
        let currentEvent = { name: null, data: "" };
        while (true) {
          const { done, value } = await reader.read();
          if (done) {
            // å¤„ç†æœ€åä¸€ä¸ªäº‹ä»¶
            if (currentEvent.name) {
              this.handleEvent(currentEvent, aiMessage);
            }
            isStreamComplete = true;
            break;
          }
          buffer += decoder.decode(value, { stream: true });
          const lines = buffer.split("\n");
          buffer = lines.pop();
          for (const line of lines) {
            if (line.trim() === "") {
              // ç©ºè¡Œè¡¨ç¤ºä¸€ä¸ªäº‹ä»¶ç»“æŸ
              if (currentEvent.name) {
                this.handleEvent(currentEvent, aiMessage);
                currentEvent = { name: null, data: "" };
              }
            } else if (line.startsWith("event:")) {
              currentEvent.name = line.split(":")[1];
            } else if (line.startsWith("data:")) {
              currentEvent.data += line.slice(5);
            }
          }
        }
        if (isStreamComplete) {
          this.getHistory();
        }
      } catch (error) {
        console.error("è¯·æ±‚å‡ºé”™:", error);
        this.$message.error('å›ç­”å¼‚å¸¸ä¸­æ–­ï¼Œè¯·ç¨åé‡è¯•ï¼')
      }
    },
    async fetchData(url, data, aiMessage) {
      return this.fetchDataCommon(url, data, aiMessage, {});
    },
    async fetchData2(url, data, aiMessage) {
      return this.fetchDataCommon(url, data, aiMessage, {
        "Content-Type": "application/json",
      });
    },
    shouldForceRender(text) {
      // å®šä¹‰éœ€è¦å¼ºåˆ¶æ¸²æŸ“çš„æ ‡è®°
      const forceRenderMarkers = [
        "###",
        "##",
        "####", // æ–°å¢è¿™ä¸€é¡¹
        "\n\n",
        "ã€‚",
        "ï¼",
        "ï¼Ÿ",
      ];
      return forceRenderMarkers.some((marker) => text.includes(marker));
    },
    // è¾…åŠ©å‡½æ•°ï¼Œæ ¹æ® type è·å–å¯¹åº”çš„ buffer é”®å
    getBufferKey(type) {
      return type === "æ€è€ƒ" ? "thinkingBuffer" : "answerBuffer";
    },
    // è¾…åŠ©å‡½æ•°ï¼Œæ ¹æ® type è·å–å¯¹åº”çš„å®Œæ•´ markdown é”®å
    getCompleteMarkdownKey(type) {
      return type === "æ€è€ƒ"
        ? "thinkingCompleteMarkdown"
        : "answerCompleteMarkdown";
    },
    // è¾…åŠ©å‡½æ•°ï¼Œæ ¹æ® type è·å–å¯¹åº”çš„èŠå¤©è®°å½•é”®å
    getChatKey(type) {
      return type === "æ€è€ƒ" ? "thinking" : "answer";
    },
    // æ¸²æŸ“ Markdown å†…å®¹
    renderMarkdown(type) {
      const bufferKey = this.getBufferKey(type);
      if (!this[bufferKey]) return;

      try {
        const completeMarkdownKey = this.getCompleteMarkdownKey(type);
        // æ¸²æŸ“æ–°å†…å®¹
        const renderedContent = this.md.render(this[completeMarkdownKey]);

        this.$nextTick(() => {
          const chatKey = this.getChatKey(type);
          // æ›´æ–° DOM
          this.chats[this.chats.length - 1][chatKey] = renderedContent;

          // æ¸…ç©ºç¼“å†²åŒº
          this[bufferKey] = "";

          // æ»šåŠ¨åˆ°åº•éƒ¨ï¼ˆå¦‚æœéœ€è¦ï¼‰
          this.scrollToBottom();
        });
      } catch (error) {
        console.error("Markdown æ¸²æŸ“é”™è¯¯:", error);
        this.$message.error('Markdown æ¸²æŸ“é”™è¯¯')
      }
    },

    scrollToBottom() {
      this.$nextTick(() => {
        const chatContainer = this.$refs.cultureBox;
        if (chatContainer) {
          chatContainer.scrollTop = chatContainer.scrollHeight;
        }
      });
    },
    sendMessage() {
      this.transcript = "";
      this.answerBuffer = "";
      this.thinkingBuffer = "";
      this.thinkingCompleteMarkdown = "";
      this.answerCompleteMarkdown = "";
      let id = this.chats.length;
      if (this.isTextEmpty) {
        this.$message.error("è¿˜æ²¡è¯´å‘¢");
        return;
      } else {
        if (this.uploadImgUrl !== "") {
          this.sendImg();
        } else {
          let message = {
            id: id,
            type: "user",
            avatar: this.$store.state.avatarImageUrl,
            thinking: "",
            answer: "",
            content: this.textarea,
            imgUrl: "",
            modules: [],
          };
          console.log(message);

          const aiMessage = {
            id: id + 1,
            type: "assistant",
            avatar:
              "https://oss-mtc.oss-cn-hangzhou.aliyuncs.com/2c927a761478a4a4248706b534bac146.gif",
            thinking: "",
            answer: "",
            content: "",
            imgUrl: "",
            modules: [],
          };

          this.chats.push(message);
          this.isThinking = true;
          this.$nextTick(() => {
            const chatContainer = this.$refs.cultureBox;
            if (chatContainer) {
              chatContainer.scrollTop = chatContainer.scrollHeight;
            }
          });

          const url = `${this.$baseUrl}agent/chat`;

          const chatAto = {
            message: message.content,
            historyId: this.historyId,
          };
          console.log(chatAto);

          this.isThinking = true;
          this.fetchData2(url, chatAto, aiMessage);
          setTimeout(() => {
            this.getHistoryId();
          }, 500);

          this.textarea = "";
          this.transcript = "";
          this.textareaHeight = 3;
          this.uploadImgUrl = "";
        }
      }
    },
    sendCity(city) {
      this.transcript = "";
      this.$store.dispatch("setCity", city);
      let message = {
        type: "user",
        avatar: this.$store.state.avatarImageUrl,
        content: `æˆ‘æƒ³äº†è§£${city}çš„æ–‡åŒ–`,
        imgUrl: "",
        modules: [],
      };

      const aiMessage = {
        type: "assistant",
        avatar:
          "https://oss-mtc.oss-cn-hangzhou.aliyuncs.com/2c927a761478a4a4248706b534bac146.gif",
        content: `ä¸‹é¢æ˜¯${city}æ–‡åŒ–ç›²ç›’ï¼Œæ‰“å¼€çœ‹çœ‹å§ï¼`,
        imgUrl: "",
        modules: [
          {
            title: "",
            tip: "",
            bck: "https://oss-mtc.oss-cn-hangzhou.aliyuncs.com/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20250423115437.jpg",
            content: "123456789012345678990",
          },
          {
            title: "",
            tip: "",
            bck: "https://oss-mtc.oss-cn-hangzhou.aliyuncs.com/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20250423115440.jpg",
            content: "123456789012345678990",
          },
          {
            title: "",
            tip: "",
            bck: "https://oss-mtc.oss-cn-hangzhou.aliyuncs.com/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20250423115428.jpg",
            content: "123456789012345678990",
          },
          {
            title: "",
            tip: "",
            bck: "https://oss-mtc.oss-cn-hangzhou.aliyuncs.com/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20250423115432.jpg",
            content: "123456789012345678990",
          },
        ],
      };

      this.chats.push(message);
      this.isThinking = true;
      this.$nextTick(() => {
        const chatContainer = this.$refs.cultureBox;
        if (chatContainer) {
          chatContainer.scrollTop = chatContainer.scrollHeight;
        }
      });
      setTimeout(() => {
        this.isThinking = false;
        this.chats.push(aiMessage);
        this.$nextTick(() => {
          const chatContainer = this.$refs.cultureBox;
          if (chatContainer) {
            chatContainer.scrollTop = chatContainer.scrollHeight;
          }
        });
      }, 300);
      this.textarea = "";
      this.transcript = "";
      this.textareaHeight = 3;
    },

    sayingInMessage() {
      this.isRecording = !this.isRecording;

      if (this.isRecording) {
        this.$refs.questionTextarea.focus();
        this.recognition.start();
      } else {
        this.$refs.questionTextarea.focus();
        this.recognition.stop();
      }
    },
    changLanguage(id,row) {
      this.translateLanguage = row.code;
      this.translateText(id)
      // alert(this.translateLanguage)
    },
    translateText(id) {
      const aiMessage = {
        id: id + 1,
        type: "assistant",
        avatar:
          "https://oss-mtc.oss-cn-hangzhou.aliyuncs.com/2c927a761478a4a4248706b534bac146.gif",
        thinking: "",
        answer: "",
        content: "",
        imgUrl: "",
        modules: [],
      };
      this.chats.push(aiMessage);
      console.log(this.chats);
      console.log(id);

      let translate = {
        language: this.translateLanguage,
        text: this.chats[id].thinking,
      };
      console.log("1:" + translate.language);
      console.log("1:" + translate.text);

      axios
        .post(`${this.$baseUrl}agent/translate`, translate, {
          headers: {
            token: `${this.$store.state.token}`,
          },
        })
        .then((response) => {
          this.isThinking = false;
          this.chats[this.chats.length - 1].thinking = this.md.render(
            response.data
          );
          this.$nextTick(() => {
            const chatContainer = this.$refs.cultureBox;
            if (chatContainer) {
              chatContainer.scrollTop = chatContainer.scrollHeight;
            }
          });
          translate.text = this.chats[id - 1].answer;
          console.log("2:" + translate.language);
          console.log("2:" + translate.text);
          axios
            .post(`${this.$baseUrl}agent/translate`, translate, {
              headers: {
                token: `${this.$store.state.token}`,
              },
            })
            .then((response) => {
              this.chats[this.chats.length - 1].answer = this.md.render(
                response.data
              );
              this.$nextTick(() => {
                const chatContainer = this.$refs.cultureBox;
                if (chatContainer) {
                  chatContainer.scrollTop = chatContainer.scrollHeight;
                }
              });
            })
            .catch((error) => {
              console.log(error.message);
              this.$message,console.error("æœåŠ¡å™¨ç¹å¿™ï¼Œè¯·ç¨åé‡è¯•");
              
            });
        })
        .catch((error) => {
          clearTimeout(timeoutId);
          this.isThinking = false;
          console.log(error.message);
           this.$message,console.error("æœåŠ¡å™¨ç¹å¿™ï¼Œè¯·ç¨åé‡è¯•");
        });
      this.$nextTick(() => {
        const chatContainer = this.$refs.cultureBox;
        if (chatContainer) {
          chatContainer.scrollTop = chatContainer.scrollHeight;
        }
      });
    },
    deleteUploadImgUrl() {
      this.uploadImgUrl = "";
    },
    showFileInput() {
      if (this.uploadImgUrl === "") {
        this.$refs.fileInput.click();
      } else {
        this.uploadImgUrl = "";
        this.$refs.fileInput.click();
      }
    },
    handleFileUpload(event) {
      this.selectedFile = event.target.files[0];
      this.uploadImgUrl = URL.createObjectURL(this.selectedFile);
      if (this.selectedFile) {
        const reader = new FileReader();
        // è¯»å–æ–‡ä»¶ä½œä¸º data URL
        reader.readAsDataURL(this.selectedFile);
      }
    },
    getHistoryId() {
      axios
        .post(
          `${this.$baseUrl}agent/getHistoryId`,
          {},
          {
            headers: {
              token: `${this.$store.state.token}`,
            },
          }
        )
        .then((response) => {
          this.historyId = response.data;
          // console.log(this.historyId);
        })
        .catch((error) => {
          this.$message,console.error("æœåŠ¡å™¨ç¹å¿™ï¼Œè¯·ç¨åé‡è¯•");
          console.log("History Error:" + error.message);
        });
    },
    getHistory() {
      axios
        .post(
          `${this.$baseUrl}agent/histories`,
          {},
          {
            headers: {
              token: `${this.$store.state.token}`,
            },
          }
        )
        .then((response) => {
          //  this.$set(this, 'historyes', response.data);
          this.historyes = response.data;
          // console.log(response.data);

          // console.log(this.historyes);
        })
        .catch((error) => {
          // this.$message.error("History Error:" + error.message);
          console.log("History Error:" + error.message);
        });
    },
    backHistory(id) {
      this.historyId = id;
      this.getHistory();
      // console.log("hid  " + this.historyId);

      for (const time in this.historyes.histories) {
        if (this.historyes.histories.hasOwnProperty(time)) {
          const historyItem = this.historyes.histories[time];
          if (historyItem.historyId === id) {
            const newChats2 = [];
            this.translateId = 0;
            historyItem.messages.forEach((msg) => {
              // console.log("msg:" + msg);
              this.translateId++;
              const newChat = {
                id: this.translateId,
                type: msg.role,
                avatar:
                  msg.role === "assistant"
                    ? "https://oss-mtc.oss-cn-hangzhou.aliyuncs.com/2c927a761478a4a4248706b534bac146.gif"
                    : this.$store.state.avatarImageUrl,
                thinking: "",
                answer:
                  msg.role === "assistant" ? this.md.render(msg.content) : "",
                content: msg.role === "user" ? msg.content : "",
                imgUrl: "",
                modules: [],
              };
              newChats2.push(newChat);
              // console.log("newChats2:" + newChats2);
            });
            this.$set(this, "chats", newChats2);
            this.$nextTick(() => {
              const chatContainer = this.$refs.cultureBox;
              if (chatContainer) {
                chatContainer.scrollTop = chatContainer.scrollHeight;
              }
            });
            console.log("this.chats:" + this.chats);

            return;
          }
        }
      }
    },
    deleteHistory(id) {
      const formData = new FormData();
      formData.append("historyId", id);
      axios
        .post(`${this.$baseUrl}agent/deleteHistory`, formData, {
          headers: {
            token: `${this.$store.state.token}`,
          },
        })
        .then((response) => {
          this.getHistory();
        })
        .catch((error) => {
          // this.$message.error(error.message);
          console.log(error.message);
        });
    },
    newSaying() {
      this.historyId = "";
      this.$set(this, "chats", []);
    },
    exit() {
      this.changePage("Login");
      this.$store.dispatch("setAdmin", "");
      this.$store.dispatch("setToken", "");
    },
  },
};
</script>

<style scoped lang="scss">
.container {
  width: 100vw;
  overflow: hidden;
}

.first-box {
  position: relative;
  width: 100vw;
  height: 100vh;
  /* ä½¿ç”¨è§†å£å•ä½ */
  overflow: hidden;
}

.header-image {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  transition: transform 0.1s ease-out;
  height: 102%;
  /* æ ¹æ®éœ€è¦è°ƒæ•´ */
}

.faceBox {
  width: 100vw;
  height: 200vh;
  position: absolute;
  top: 0;
  left: 0;
  user-select: none;
  /* æ–‡æœ¬ä¸å¯é€‰ä¸­ */
  font-family: KaiTi;
  transition: all 1s ease-in-out;
}

.faceBox-up {
  background-color: #202020;
  opacity: 0.8;
  transform: translateY(-100vh);
}

.first-face-title {
  width: 100vw;
  height: 100vh;
  justify-content: center;
  /* æ°´å¹³å±…ä¸­ */
  align-items: center;
  /* å‚ç›´å±…ä¸­ */
  display: flex;
  /* background-color: aqua; */
}

.first-face-title p {
  font-weight: 800;
  font-size: 50px;
  letter-spacing: 20px;
  color: rgb(234, 230, 238);
}

.face-text {
  width: 100vw;
  height: 100vh;
  /* background-color: pink; */
  justify-content: center;
  /* æ°´å¹³å±…ä¸­ */
  align-items: center;
  /* å‚ç›´å±…ä¸­ */
  display: flex;
}

.face-text p {
  width: 40vw;
  /* height: 40vh; */
  word-wrap: break-word;
  font-size: 40px;
  letter-spacing: 10px;
  color: rgb(213, 202, 202);
}

@font-face {
  font-family: "xingshu";
  /* å¯ä»¥æ˜¯ä»»æ„åç§° */
  src: url("@/assets/font/xingshu.ttf") format("truetype");
  font-weight: normal;
  font-style: normal;
  font-display: swap;
}

.second-box {
  width: 100vw;
  height: 103vh;
  margin: 0;
  padding: 0;
  border: 0;
  outline: 0;
  font-size: 100%;
  vertical-align: baseline;
  background: transparent;
}

.third-box {
  width: 100vw;
  height: 100vh;
  margin: 0;
  padding: 0;
  border: 0;
  outline: 0;
  overflow: hidden;
  position: relative;
  background-color: #5c2223;
  background-image: url("@/assets/image/Home/02bck.png");
}

.wrapper {
  position: relative;
  width: 100%;
  height: 100%;
  background-image: url("@/assets/image/Home/02bck.png");
  transition: background-color 2s ease-in;
  /* background-color: #ddd; */
}

.color-box {
  position: absolute;
  width: 30%;
  height: 90%;
  /* background-color: aqua; */
  top: 10%;
  left: 8%;
  overflow: scroll;
  /*éšè—æ»šåŠ¨æ¡*/
  -ms-overflow-style: none;
  /* Internet Explorer å’Œ Edge */
  scrollbar-width: none;
  /* Firefox ç§æœ‰å±æ€§ */
}

.message-box {
  position: absolute;
  width: 30%;
  height: 75%;
  top: 10%;
  right: 30%;
  display: flex;
  margin-top: 5px;
}

.color-list {
  width: 100%;
  display: flex;
  flex-wrap: wrap;
  /* å…è®¸å­å…ƒç´ æ¢è¡Œ */
}

.color-value {
  width: 16%;
  height: 100%;
}

.color-son {
  width: 100%;
  height: 14.13%;
  /* background-color: red; */
  position: relative;
  border-bottom: #fff 1px solid;
  color: #fff;
  transition: 1s;
}

.C {
  border-top: #fff 2px solid;
}

.color-title {
  width: 100%;
  height: 10%;
  position: relative;
}

.color-title p {
  position: absolute;
  top: 0%;
  left: 10%;
  font-size: 12px;
}

.color-circular {
  width: 100%;
  height: 90%;
  position: absolute;
  top: 25%;
  left: 20%;
}

.color-circular span {
  position: absolute;
  top: 22%;
  left: 15%;
  font-size: 18px;
  width: 35px;
  /* background-color: aqua; */
  text-align: center;
}

.rgb span {
  display: block;
  position: absolute;
  bottom: 7%;
  right: 5%;
  font-size: 200%;
  font-weight: 300;
}

.color-name {
  width: 70%;
  height: 100%;
  text-align: center;
  color: #fff;
}

.p-name {
  font-size: 750%;
  font-family: "xingshu", kaiti;
  margin-top: 10%;
  margin-left: 7vw;
  writing-mode: vertical-rl;
  /* æ–‡æœ¬ä»ä¸Šåˆ°ä¸‹ã€ä»å³åˆ°å·¦ */
}

.p-pinyin {
  font-size: 21px;
  font-weight: 600;
  font-family: "Times New Roman", Times, serif;
}

.color-img {
  width: 14%;
  height: 100%;
}

.color-img img {
  width: 65%;
  height: 70%;
  margin-top: 55%;
}

.color-item {
  /* background-color: palegoldenrod; */
  border-top: 7px solid;
  width: 13%;
  height: 265px;
  margin: 3px;
  margin-top: 5px;
  cursor: pointer;
  transition: opacity 0.6s;
}

.color-item:hover {
  opacity: 0.5;
}

.color-top {
  display: flex;
  margin-top: 13px;
}

.top-name {
  writing-mode: vertical-rl;
  margin-left: 5px;
}

.color-bottom {
  margin-top: 12px;
  margin-right: 20px;
  transform: rotate(90deg);
  /* é¡ºæ—¶é’ˆæ—‹è½¬90åº¦ */
  color: #fff;
  font-size: 11px;
}

.top-value {
  margin-top: 3px;
}

.wrapper-title {
  position: absolute;
  /* top: 10%; */
  right: 3%;
  width: 25%;
  height: 75%;
  text-align: center;
  /* background-color: aqua; */
}

.wrapper-title span {
  /* display: block; */
  font-family: "xingshu", kaiti;
  font-size: 130px;
  margin-top: 80px;
  margin-right: 80px;
  color: #fff;
  writing-mode: vertical-lr;
}

.third-bottom {
  width: 100vw;
  height: 100vh;
  position: relative;
  /* background-color: #202020; */
  background-image: url("@/assets/image/Home/02bck.png");
}

.third-top-left,
.third-top-right {
  width: 50%;
  height: 100%;
  text-align: center;
  color: #5c2223;
  background-color: #202020;
  background-image: url("@/assets/image/Home/02bck.png");
  font-size: 500px;
  font-family: "xingshu", kaiti;
  position: absolute;
  transition: 0.7s;
  /* border: #fff 1px solid; */
  z-index: 10;
}

.third-top-left {
  top: 0;
  left: 0;
}

.third-top-right {
  top: 0;
  right: 0;
}

.third-top-left span,
.third-top-right span {
  position: absolute;
  /* background-color: #fff; */
  top: 20%;
  right: 20%;
}

.third-click-btn-next {
  width: 60px;
  position: absolute;
  /* background-color: #fff; */
  bottom: 10%;
  right: 20%;
  cursor: pointer;
  /* transition: 0.5s; */
  animation: img-breath 2.5s linear infinite;
}

.third-click-btn-last {
  width: 60px;
  position: absolute;
  top: 100vh;
  left: 0;
  margin-top: -95vh;
  margin-left: 3.5vw;
  cursor: pointer;
  transition: 0.7s;
  animation: img-breath 2.5s linear infinite;
}

@keyframes img-breath {
  0% {
    opacity: 1;
  }

  50% {
    opacity: 0.35;
  }

  100% {
    opacity: 1;
  }
}

.third-bottom-contain {
  width: 100vw;
  height: 85vh;
}

.third-bottom-title {
  width: 80vw;
  height: 15vh;
  /* background-color: aqua; */
  margin-left: 12vw;
  text-align: center;
}

.third-bottom-title h2 {
  font-family: kaiti;
  font-size: 60px;
  /* background-color: beige; */
  display: block;
  color: #fff;
  letter-spacing: 15px;
}

.third-bottom-contain-left {
  width: 16vw;
  height: 83vh;
  /* background-color: palegoldenrod; */
  margin-left: 1vw;
  margin-top: -2vh;
}

.video-box {
  width: 100%;
  height: 22%;
  /* background-color: aqua; */
  margin-top: 2.5vh;
  cursor: pointer;
  border-radius: 8px;
}

.video-face {
  width: 16vw;
  height: 18.26vh;
  overflow: hidden;
  transition: 0.5s;
  /* background-color: red; */
  position: absolute;
  z-index: 0;
  border-radius: 8px;
}

.video-face:hover {
  transform: scale(1.1);
  box-shadow: 0 25px 40px rgba(0, 0, 0, 0.5);
  z-index: 1;
}

.face-img img {
  width: 16vw;
  height: 18.26vh;
  border-radius: 8px;
}

.face-title {
  position: absolute;
  left: 0;
  top: 0;
  width: 90%;
  height: 100%;
  display: flex;
  align-items: flex-end;
  color: #fff;
}

.face-title h2 {
  font-size: 18px;
  font-family: kaiti;
  margin-bottom: 10px;
  transform: translateY(200px);
  transition: 0.5s;
}

.video-face:hover .face-title h2 {
  transform: translate(0);
  transition-delay: 0.3s;
}

.face-title p {
  font-size: 13px;
  font-weight: 300;
  font-family: kaiti;
  line-height: 20px;
  white-space: 2px;
  transform: translateY(250px);
  letter-spacing: 2px;
  transition: 0.5s;
}

.video-face:hover .face-title p {
  transform: translateY(0);
  transition-delay: 0.15s;
}

.third-bottom-contain-right {
  width: 80vw;
  height: 82.2vh;
  background-color: rgba(33, 1, 1, 0.65);
  margin-left: 18vw;
  margin-top: -83vh;
  border-radius: 5px;
  display: flex;
}

.third-bottom-right-son1,
.third-bottom-right-son2,
.third-bottom-right-son3,
.third-bottom-right-son4 {
  width: 19.5vw;
  height: 77vh;
  margin-left: 20px;
  margin-top: 19px;
  /* background-color: aqua; */
  font-family: kaiti;
}

.third-bottom-right-son2 {
  width: 15vw;
  margin-left: 5px;
}

.third-bottom-right-son3 {
  margin-left: 5px;
}

.third-bottom-right-son4 {
  width: 22vw;
}

.son-box {
  width: 19.5vw;
  height: 30.5vh;
  /* background-color: blueviolet; */
  transition: 0.5s;
  cursor: pointer;
  margin-bottom: 1vh;
  margin-top: 1vh;
}

.son-box:hover,
.son4-box:hover {
  transform: scale(1.05);
  box-shadow: 0 25px 40px rgba(0, 0, 0, 0.5);
}

.cloud2 {
  width: 15vw;
  height: 13vh;
  /* background-color: rgb(15, 15, 11); */
}

.cloud2 img {
  transform: scaleX(-1);
  float: right;
  margin-right: -1.5vw;
  margin-top: 1vh;
  height: 11vh;
}

.cloud21 img {
  margin-right: 1.3vw;
}

.cloud1 {
  width: 15vw;
  height: 31.5vh;
  /* background-color: rgb(77, 77, 12); */
}

.cloud1 img {
  height: 14vh;
  margin-top: 6.5vh;
  margin-left: 3vw;
}

.son-box-img img {
  width: 19.5vw;
  height: 21.6vh;
}

.son-box h2,
.son-box p {
  display: block;
}

.son-box h2 {
  color: #fff;
  font-size: 20px;
  margin: 2px;
}

.son-box p {
  color: #fff;
  font-size: 16px;
  margin-left: 5px;
  margin-right: 5px;
  margin-bottom: 5px;
}

.son4-box {
  width: 22vw;
  height: 75vh;
  transition: 0.5s;
  cursor: pointer;
}

.son4-box-img img {
  width: 22vw;
  height: 63vh;
}

.son4-box-text h2 {
  color: #fff;
  font-size: 20px;
  margin: 5px;
}

.son4-box-text p {
  color: #fff;
  font-size: 16px;
  margin-left: 5px;
  margin-right: 5px;
  margin-bottom: 5px;
}

.fourth-box {
  width: 100vw;
  height: 100vh;
  display: flex;
  transition: 0.3s;
  position: relative;
}

.mapBox {
  width: 50vw;
  height: 100vh;
  background-color: #d8e3e7;
  display: flex;
  background-image: url("@/assets/image/Home/02bck.png");
  position: relative;
}

.allMapBox {
  width: 48.5vw;
  height: 100vh;
}

.mapChange {
  width: 1.5vw;
  height: 25px;
  /* background-color: #2376b7; */
  position: absolute;
  right: 0;
  top: 50%;
  transform: translateY(-50%);
  z-index: 2;
  cursor: pointer;
  transition: 0.3s;

  i {
    font-size: 25px;
    font-weight: 700;
    color: #fff;
  }
}

.hideMap {
  transform: translateX(-48.5vw);
}

#allmap {
  width: 100%;
  height: 100%;
}

.cultureBox {
  width: 50vw;
  /* max-height: 90vh;
  min-height: 87vh; */
  height: 95vh;
  background-color: #5c2223;
  position: relative;
  overflow: auto;
  /* background: linear-gradient(90deg, rgba(255, 215, 186, 0.3) 0%, rgba(251, 228, 216, 0.3) 100%); */
  background-image: url("@/assets/image/Home/02bck.png");
  transition: 0.3s;
}

/* è®¾ç½®æ•´ä¸ªæ»šåŠ¨æ¡çš„å®½åº¦ */
.cultureBox::-webkit-scrollbar {
  width: 6px;
  /* æ»šåŠ¨æ¡å®½åº¦è®¾ç½®å¾—è¾ƒçª„ä»¥æ˜¾å¾—æ›´ç»† */
}

/* æ»šåŠ¨æ¡è½¨é“ */
.cultureBox::-webkit-scrollbar-track {
  background: rgba(204, 204, 214, 0.4);
  /* è½¨é“èƒŒæ™¯è‰²é€æ˜åº¦è¾ƒä½ï¼Œä½¿è½¨é“ä¸é‚£ä¹ˆæ˜æ˜¾ */
  border-radius: 10px;
}

/* æ»šåŠ¨æ¡æ»‘å— */
.cultureBox::-webkit-scrollbar-thumb {
  background: rgba(204, 204, 214, 0.7);
  /* æ»‘å—é¢œè‰²ç¨å¾®æ·±ä¸€ç‚¹ï¼Œä½†ä»ç„¶ä¿æŒä½è°ƒ */
  border-radius: 10px;
}

/* å½“ç”¨æˆ·æ‚¬åœåœ¨æ»šåŠ¨æ¡ä¸Šæ—¶ï¼Œæ”¹å˜æ»‘å—çš„é¢œè‰² */
.cultureBox::-webkit-scrollbar-thumb:hover {
  background: rgba(204, 204, 214, 1);
  cursor: pointer;
  /* é¼ æ ‡æ‚¬åœæ—¶ï¼Œæ»‘å—é¢œè‰²å˜å¾—æ›´æ·±ä¸€äº› */
}

.avatarBox {
  position: relative;
  width: 50px;
  height: 50px;
  margin: 15px;
  cursor: pointer;
  /* background-color: beige; */
}

.avatarBox-right {
  order: 2;
}

.avatarBox img {
  position: absolute;
  display: block;
  width: 50px;
  height: 50px;
  border-radius: 20px;
}

.fourth-right {
  width: 50vw;
  height: 100vh;
  display: flex;
  background-image: url("@/assets/image/Home/02bck.png");
  /* background-color: #ccccd6; */
  flex-direction: column;
  /* å‚ç›´æ’åˆ—å­å…ƒç´  */
  align-items: flex-start;
  /* å­å…ƒç´ æ²¿äº¤å‰è½´ï¼ˆåœ¨è¿™ä¸ªæ¡ˆä¾‹ä¸­æ˜¯æ°´å¹³æ–¹å‘ï¼‰çš„èµ·ç‚¹å¯¹é½ */
}

.hide-cultureBox {
  width: 78.5vw;
}

.dialogBox {
  width: 100%;
  /* padding:10px; */
  /* background-color: #a17b7c; */
  background-image: url("@/assets/image/Home/02bck.png");
  display: flex;
  margin-bottom: 10px;
  align-items: flex-start;
  position: relative;
  /* è®©å­å…ƒç´ åœ¨äº¤å‰è½´èµ·å§‹ä½ç½®å¯¹é½ */
}

.dialogBox-right {
  justify-content: flex-end;
}

.contentBox {
  max-width: 76%;
  margin-top: 10px;
  height: auto;
  padding: 20px;
  background-color: #f7f4ed;
  background-image: url("@/assets/image/Home/02bck.png");
  border-radius: 15px;
}

.contentBox-right {
  order: 1;
}

.contentText {
  height: auto;
  font-family: kaiti;
  /* display: flex; */
  // åˆ—è¡¨æ ·å¼
  ::v-deep ul,
  ::v-deep ol {
    margin: 1.5rem 0;
    padding-left: 2rem;
    list-style: none; // ç§»é™¤é»˜è®¤åˆ—è¡¨æ ·å¼

    li {
      margin-bottom: 0.8rem;
      position: relative;
      padding-left: 1rem;

      &::before {
        position: absolute;
        left: -1rem;
        color: #ff9900;
      }
    }
  }

  ::v-deep ul li::before {
    content: "âœ¦";
  }

  ::v-deep ol {
    counter-reset: item;

    ::v-deep li {
      counter-increment: item;

      &::before {
        content: counter(item) ".";
        font-weight: bold;
      }
    }
  }

  p {
    display: block;
    font-family: kaiti;
    font-size: 18px;
    word-wrap: break-word;
    margin: 0;
    padding: 3px;
  }

  .thinking {
    background-color: #ede6d6;
    border-radius: 15px;
    padding: 6px;
    color: #495057;
  }

  img {
    display: block;
  }
}

/* .contentText p {

} */

.contentModule {
  /* width: 640px; */
  /* height: 350px; */
  margin-top: 10px;
  /* background-color: #5c2223; */
  display: flex;
}

.cultureIntroduce {
  width: 200px;
  height: 300px;
  background-color: aqua;
  border-radius: 15px;
  background: url("@/assets/image/Home/mei.jpg") center center;
  background-size: cover;
  cursor: pointer;
  transition: 0.6s;
}

.questionAnswer {
  width: 200px;
  height: 300px;
  border-radius: 15px;
  margin-left: 20px;
  background: url("@/assets/image/Home/lan.jpg");
  background-size: cover;
  cursor: pointer;
  transition: 0.6s;
}

.moduleSonBox {
  margin-left: 20px;
}

.scenicIntroduce {
  width: 200px;
  height: 180px;
  border-radius: 15px;
  background: url("@/assets/image/Home/zhu.jpg") center center;
  background-size: cover;
  cursor: pointer;
  transition: 0.6s;
}

.AIDraw {
  width: 200px;
  height: 105px;
  border-radius: 15px;
  margin-top: 15px;
  background: url("@/assets/image/Home/jv.jpg") center center;
  background-size: cover;
  cursor: pointer;
  transition: 0.6s;
}

.cultureIntroduce:hover,
.questionAnswer:hover,
.scenicIntroduce:hover,
.AIDraw:hover {
  transform: scale(1.05);
  box-shadow: 0 25px 40px rgba(0, 0, 0, 0.3);
}

.el-icon-s-promotion {
  font-size: 30px;
  position: absolute;
  right: 3vh;
  bottom: 0.5vh;
  width: 5vh;
  height: 5vh;
  border-radius: 100%;
  background-color: #fff;
  cursor: not-allowed;
  transition: color 0.3s;
  display: flex;
  justify-content: center;
  /* æ°´å¹³å±…ä¸­ */
  align-items: center;
  /* å‚ç›´å±…ä¸­ */
}

.el-icon-s-promotion-allowed {
  cursor: pointer;
}

.icon-color-empty {
  color: gray;
  /* æ— æ–‡å­—æ—¶çš„é¢œè‰² */
}

.icon-color-filled {
  color: #2ba257;
  /* æœ‰æ–‡å­—æ—¶çš„é¢œè‰² */
}

.el-icon-microphone {
  font-size: 30px;
  padding: 5px;
  border-radius: 100%;
  background-color: #fff;
  color: gray;
  cursor: pointer;
  position: absolute;
  bottom: 0.5vh;
  right: 9vh;
  transition: 0.3s;
}

.el-icon-picture-outline-round {
  font-size: 30px;
  padding: 5px;
  border-radius: 100%;
  background-color: #fff;
  color: gray;
  cursor: pointer;
  position: absolute;
  bottom: 0.5vh;
  right: 15vh;
  transition: 0.3s;
}

.saying {
  background-color: rgb(244, 52, 52);
  color: #fff;
}

.el-icon-microphone:hover {
  color: #2ba257;
}

.el-icon-picture-outline-round:hover {
  color: #2ba257;
}

.saying:hover {
  color: #fff;
}

.inputBox {
  width: 50vw;
  background-color: #d8e3e7;
  transition: 0.5s;
  display: flex;
  position: relative;
  padding: 0.5vh;
  box-sizing: border-box;
  border: 1.5px solid rgba(255, 0, 0, 0);
  transition: 0.3s;
  /* border-radius: 15px 15px 0 0; */
}

.hide-inputBox {
  width: 78.5vw;
}

.inputBox:hover {
  border-color: #2376b7;
}

.question-textarea {
  width: 37vw;
  resize: none;
  font-size: 20px;
  padding: 10px;
  margin-left: 1vw;
  font-family: kaiti;
  border: none;
  outline: none;
  background-color: #d8e3e7;
  /* background-color: red; */
  caret-color: #2376b7;
  /* ä¿®æ”¹å…‰æ ‡é¢œè‰²ä¸ºçº¢è‰² */
}

.hide-question-textarea {
  width: 63.5vw;
}

/* è®¾ç½®æ•´ä¸ªæ»šåŠ¨æ¡çš„å®½åº¦ */
.question-textarea::-webkit-scrollbar {
  width: 6px;
  /* æ»šåŠ¨æ¡å®½åº¦è®¾ç½®å¾—è¾ƒçª„ä»¥æ˜¾å¾—æ›´ç»† */
}

/* æ»šåŠ¨æ¡è½¨é“ */
.question-textarea::-webkit-scrollbar-track {
  background: rgba(204, 204, 214, 0.4);
  /* è½¨é“èƒŒæ™¯è‰²é€æ˜åº¦è¾ƒä½ï¼Œä½¿è½¨é“ä¸é‚£ä¹ˆæ˜æ˜¾ */
  border-radius: 10px;
}

/* æ»šåŠ¨æ¡æ»‘å— */
.question-textarea::-webkit-scrollbar-thumb {
  background: rgba(235, 235, 237, 0.995);
  /* æ»‘å—é¢œè‰²ç¨å¾®æ·±ä¸€ç‚¹ï¼Œä½†ä»ç„¶ä¿æŒä½è°ƒ */
  border-radius: 10px;
}

/* å½“ç”¨æˆ·æ‚¬åœåœ¨æ»šåŠ¨æ¡ä¸Šæ—¶ï¼Œæ”¹å˜æ»‘å—çš„é¢œè‰² */
.question-textarea::-webkit-scrollbar-thumb:hover {
  background: rgb(249, 249, 250);
  /* é¼ æ ‡æ‚¬åœæ—¶ï¼Œæ»‘å—é¢œè‰²å˜å¾—æ›´æ·±ä¸€äº› */
  cursor: pointer;
}

/* ç¦æ­¢ placeholder æ–‡å­—è¢«é€‰ä¸­ */
::-webkit-input-placeholder {
  user-select: none;
}

::-moz-placeholder {
  user-select: none;
}

:-ms-input-placeholder {
  user-select: none;
}

::placeholder {
  user-select: none;
}

.limit-tip {
  position: absolute;
  right: 2.5vh;
  bottom: 6.5vh;
}

.aiImg {
  width: 25vw;
}

.operateBox {
  margin-bottom: -10px;
  display: flex;
  justify-content: start;
  margin-bottom: 10px;
  margin-left: 85px;
  opacity: 0.35;
  max-width: 76%;
  transition: 0.3s;

  img {
    width: 18px;
  }

  img:hover {
    cursor: pointer;
  }
}

.operateBox:hover {
  opacity: 1;
}

.chatImg {
  position: relative;

  .uploadImg {
    max-width: 20vw;
  }

  .deleteDiv {
    width: 100%;
    height: 100%;
    background-color: rgb(0, 0, 0);
    position: absolute;
    top: 0;
    opacity: 0;
    transition: 0.3s;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;

    i {
      display: block;
      font-size: 30px;
      font-weight: 700;
      color: #fff;
    }
  }

  .deleteDiv:hover {
    opacity: 0.5;
  }
}

.fourth-right-right {
  width: 20vw;
  height: 100vh;
  background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
  position: absolute;
  right: -20vw;
  transition: 0.3s;
  overflow: auto;
  box-shadow: -4px 0 15px rgba(0, 0, 0, 0.05);
  background-image: url("@/assets/image/Home/02bck.png");
}

.dialog {
  width: 35vw;
  height: 45vh;
  position: absolute;
  background-color: #c3d7df;
  background-image: url("@/assets/image/Home/02bck.png");
  right: -9vw;
  box-shadow: 0 0 15px rgba(0, 0, 0, 0.3);
  top: 25vh;
  border-radius: 15px;
  padding-top: 10px;

  .dialog-close {
    width: 97%;
    text-align: end;
    font-size: 25px;
    font-weight: 700;

    i {
      color: #2c3e50;
      cursor: pointer;
    }
  }

  .block {
    width: 83%;
    margin-top: 5px;
    margin-left: 40px;
  }

  .dialog-yes {
    width: 90%;
    margin-top: 30px;

    button {
      display: block;
      float: right;
    }
  }
}

.hide-right-right {
  right: -48.5vw;
}

/* æ»šåŠ¨æ¡è½¨é“ */
.fourth-right-right::-webkit-scrollbar-track {
  background: rgba(204, 204, 214, 0.4);
  /* è½¨é“èƒŒæ™¯è‰²é€æ˜åº¦è¾ƒä½ï¼Œä½¿è½¨é“ä¸é‚£ä¹ˆæ˜æ˜¾ */
  border-radius: 10px;
}

/* æ»šåŠ¨æ¡æ»‘å— */
.fourth-right-right::-webkit-scrollbar-thumb {
  background: rgba(204, 204, 214, 0.7);
  /* æ»‘å—é¢œè‰²ç¨å¾®æ·±ä¸€ç‚¹ï¼Œä½†ä»ç„¶ä¿æŒä½è°ƒ */
  border-radius: 10px;
}

/* å½“ç”¨æˆ·æ‚¬åœåœ¨æ»šåŠ¨æ¡ä¸Šæ—¶ï¼Œæ”¹å˜æ»‘å—çš„é¢œè‰² */
.fourth-right-right::-webkit-scrollbar-thumb:hover {
  background: rgba(204, 204, 214, 1);
  cursor: pointer;
  /* é¼ æ ‡æ‚¬åœæ—¶ï¼Œæ»‘å—é¢œè‰²å˜å¾—æ›´æ·±ä¸€äº› */
}

.fourth-right-right::-webkit-scrollbar {
  width: 6px;
  /* æ»šåŠ¨æ¡å®½åº¦è®¾ç½®å¾—è¾ƒçª„ä»¥æ˜¾å¾—æ›´ç»† */
}

.history-container {
  padding: 20px;
}

.history-header {
  display: flex;
  align-items: center;
  margin-bottom: 25px;
  padding-bottom: 15px;
  border-bottom: 1px solid rgba(0, 0, 0, 0.08);
  position: relative;

  i {
    cursor: pointer;
    font-size: 30px;
    color: #2c3e50;
    position: absolute;
    top: 5px;
    right: 0;
  }
}

.history-icon {
  font-size: 28px;
  margin-right: 12px;
  filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.1));
}

.history-title {
  font-size: 22px;
  font-weight: 600;
  color: #2c3e50;
  letter-spacing: 1px;
  text-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
}

.history-item {
  margin-bottom: 12px;
  background: white;
  border-radius: 8px;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
  transition: transform 0.2s;
}

.history-item:hover {
  transform: translateX(4px);
}

.history-time {
  font-weight: 500;
  color: #6c757d;
  letter-spacing: 0.5px;
}

.history-content {
  font-size: 15px;
  line-height: 1.6;
  color: #495057;
  padding: 12px;
  background: rgba(248, 249, 250, 0.5);
  border-radius: 6px;
  margin: 10px 0;
}

.history-actions {
  display: flex;
  justify-content: flex-end;
  gap: 10px;
  padding: 8px 0;

  button {
    margin-right: 3px;
  }
}

.action-btn {
  width: 32px;
  height: 32px;
  border: none;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

.action-btn:hover {
  transform: scale(1.1);
}
.newSaying {
  display: block;
  margin-right: 40px;
  cursor: pointer;
}
.exit {
  width: 24px;
  margin-left: 28px;
  cursor: pointer;
}
</style>